float SF[22][1];
SF[0] = daz/2 - daz_b/2;
SF[1] = day/2 - day_b/2;
SF[2] = dax/2 - dax_b/2;
SF[3] = (q0*SF[1])/2 - q2/2 + (q1*SF[0])/2 + (q3*SF[2])/2;
SF[4] = q3/2 + (q0*SF[0])/2 - (q1*SF[1])/2 + (q2*SF[2])/2;
SF[5] = q0/2 + (q1*SF[2])/2 + (q2*SF[1])/2 - (q3*SF[0])/2;
SF[6] = q1/2 - (q0*SF[2])/2 + (q2*SF[0])/2 + (q3*SF[1])/2;
SF[7] = q3/2 - (q0*SF[0])/2 + (q1*SF[1])/2 + (q2*SF[2])/2;
SF[8] = q2/2 + (q0*SF[1])/2 + (q1*SF[0])/2 - (q3*SF[2])/2;
SF[9] = (q0*SF[2])/2 - q1/2 + (q2*SF[0])/2 + (q3*SF[1])/2;
SF[10] = q0/2 + (q1*SF[2])/2 - (q2*SF[1])/2 + (q3*SF[0])/2;
SF[11] = q0/2 - (q1*SF[2])/2 + (q2*SF[1])/2 + (q3*SF[0])/2;
SF[12] = q1/2 + (q0*SF[2])/2 - (q2*SF[0])/2 + (q3*SF[1])/2;
SF[13] = q2/2 - (q0*SF[1])/2 + (q1*SF[0])/2 + (q3*SF[2])/2;
SF[14] = (q0*SF[0])/2 - q3/2 + (q1*SF[1])/2 + (q2*SF[2])/2;
SF[15] = - sq(q0) - sq(q1) - sq(q2) - sq(q3);
SF[16] = dvz - dvz_b;
SF[17] = sq(q0) - sq(q1) - sq(q2) + sq(q3);
SF[18] = sq(q0) - sq(q1) + sq(q2) - sq(q3);
SF[19] = 2*q0*q1 - 2*q2*q3;
SF[20] = sq(q0) + sq(q1) - sq(q2) - sq(q3);
SF[21] = 2*q1*q3;
float SG[5][1];
SG[0] = - sq(q0) - sq(q1) - sq(q2) - sq(q3);
SG[1] = sq(q3);
SG[2] = sq(q2);
SG[3] = sq(q1);
SG[4] = sq(q0);
float SQ[8][1];
SQ[0] = - dvyNoise*(2*q0*q1 + 2*q2*q3)*(SG[1] - SG[2] + SG[3] - SG[4]) - dvzNoise*(2*q0*q1 - 2*q2*q3)*(SG[1] - SG[2] - SG[3] + SG[4]) - dvxNoise*(2*q0*q2 - 2*q1*q3)*(2*q0*q3 + 2*q1*q2);
SQ[1] = dvxNoise*(2*q0*q2 - 2*q1*q3)*(SG[1] + SG[2] - SG[3] - SG[4]) + dvzNoise*(2*q0*q2 + 2*q1*q3)*(SG[1] - SG[2] - SG[3] + SG[4]) - dvyNoise*(2*q0*q1 + 2*q2*q3)*(2*q0*q3 - 2*q1*q2);
SQ[2] = dvyNoise*(2*q0*q3 - 2*q1*q2)*(SG[1] - SG[2] + SG[3] - SG[4]) - dvxNoise*(2*q0*q3 + 2*q1*q2)*(SG[1] + SG[2] - SG[3] - SG[4]) - dvzNoise*(2*q0*q1 - 2*q2*q3)*(2*q0*q2 + 2*q1*q3);
SQ[3] = sq(SG[0]);
SQ[4] = 2*q2*q3;
SQ[5] = 2*q1*q3;
SQ[6] = 2*q1*q2;
SQ[7] = SG[4];
float SPP[21][1];
SPP[0] = 2*q2*SF[11] - 2*q0*SF[13] + 2*q1*SF[14] + 2*q3*SF[12];
SPP[1] = 2*q0*SF[9] + 2*q2*SF[7] + 2*q1*SF[10] - 2*q3*SF[8];
SPP[2] = 2*q0*SF[14] + 2*q1*SF[13] - 2*q2*SF[12] + 2*q3*SF[11];
SPP[3] = 2*q0*SF[10] - 2*q1*SF[9] + 2*q2*SF[8] + 2*q3*SF[7];
SPP[4] = 2*q0*SF[11] + 2*q1*SF[12] + 2*q2*SF[13] - 2*q3*SF[14];
SPP[5] = 2*q1*SF[8] - 2*q0*SF[7] + 2*q2*SF[9] + 2*q3*SF[10];
SPP[6] = dvx*(2*q0*q1 + 2*q2*q3) - dvy*(SF[21] - 2*q0*q2);
SPP[7] = SF[16]*(2*q0*q3 - 2*q1*q2) + dvy*(SF[21] + 2*q0*q2);
SPP[8] = 2*q0*SF[5] - 2*q2*SF[3] + 2*q1*SF[6] + 2*q3*SF[4];
SPP[9] = 2*q1*SF[5] - 2*q0*SF[6] + 2*q2*SF[4] + 2*q3*SF[3];
SPP[10] = 2*q0*SF[3] - 2*q1*SF[4] + 2*q2*SF[5] + 2*q3*SF[6];
SPP[11] = dvx*SF[17] - SF[16]*(SF[21] - 2*q0*q2);
SPP[12] = dvy*SF[17] - SF[16]*(2*q0*q1 + 2*q2*q3);
SPP[13] = sq(q0) - sq(q1) - sq(q2) + sq(q3);
SPP[14] = dvx*SF[18] - dvy*(2*q0*q3 + 2*q1*q2);
SPP[15] = dvx*SF[19] + SF[16]*(2*q0*q3 + 2*q1*q2);
SPP[16] = dvy*SF[20] + dvx*(2*q0*q3 - 2*q1*q2);
SPP[17] = SF[16]*SF[20] - dvx*(SF[21] + 2*q0*q2);
SPP[18] = SF[16]*SF[18] + dvy*SF[19];
SPP[19] = SF[21] + 2*q0*q2;
SPP[20] = SF[15];
float nextP[21][21];
nextP[0][0] = daxNoise*SQ[3] + SPP[4]*(P[0][0]*SPP[4] + P[1][0]*SPP[5] - P[2][0]*SPP[10] + P[9][0]*SPP[20]) + SPP[5]*(P[0][1]*SPP[4] + P[1][1]*SPP[5] - P[2][1]*SPP[10] + P[9][1]*SPP[20]) - SPP[10]*(P[0][2]*SPP[4] + P[1][2]*SPP[5] - P[2][2]*SPP[10] + P[9][2]*SPP[20]) + SPP[20]*(P[0][9]*SPP[4] + P[1][9]*SPP[5] - P[2][9]*SPP[10] + P[9][9]*SPP[20]);
nextP[0][1] = SPP[3]*(P[0][1]*SPP[4] + P[1][1]*SPP[5] - P[2][1]*SPP[10] + P[9][1]*SPP[20]) - SPP[2]*(P[0][0]*SPP[4] + P[1][0]*SPP[5] - P[2][0]*SPP[10] + P[9][0]*SPP[20]) + SPP[9]*(P[0][2]*SPP[4] + P[1][2]*SPP[5] - P[2][2]*SPP[10] + P[9][2]*SPP[20]) + SPP[20]*(P[0][10]*SPP[4] + P[1][10]*SPP[5] - P[2][10]*SPP[10] + P[9][10]*SPP[20]);
nextP[0][2] = SPP[0]*(P[0][0]*SPP[4] + P[1][0]*SPP[5] - P[2][0]*SPP[10] + P[9][0]*SPP[20]) - SPP[1]*(P[0][1]*SPP[4] + P[1][1]*SPP[5] - P[2][1]*SPP[10] + P[9][1]*SPP[20]) + SPP[8]*(P[0][2]*SPP[4] + P[1][2]*SPP[5] - P[2][2]*SPP[10] + P[9][2]*SPP[20]) + SPP[20]*(P[0][11]*SPP[4] + P[1][11]*SPP[5] - P[2][11]*SPP[10] + P[9][11]*SPP[20]);
nextP[0][3] = P[0][3]*SPP[4] + P[1][3]*SPP[5] - P[2][3]*SPP[10] + P[9][3]*SPP[20] + SPP[7]*(P[0][0]*SPP[4] + P[1][0]*SPP[5] - P[2][0]*SPP[10] + P[9][0]*SPP[20]) - SPP[16]*(P[0][2]*SPP[4] + P[1][2]*SPP[5] - P[2][2]*SPP[10] + P[9][2]*SPP[20]) - SPP[19]*(P[0][12]*SPP[4] + P[1][12]*SPP[5] - P[2][12]*SPP[10] + P[9][12]*SPP[20]) + (SF[16]*SF[20] - dvx*SPP[19])*(P[0][1]*SPP[4] + P[1][1]*SPP[5] - P[2][1]*SPP[10] + P[9][1]*SPP[20]);
nextP[0][4] = P[0][4]*SPP[4] + P[1][4]*SPP[5] - P[2][4]*SPP[10] + P[9][4]*SPP[20] + SF[19]*(P[0][12]*SPP[4] + P[1][12]*SPP[5] - P[2][12]*SPP[10] + P[9][12]*SPP[20]) - SPP[18]*(P[0][0]*SPP[4] + P[1][0]*SPP[5] - P[2][0]*SPP[10] + P[9][0]*SPP[20]) + SPP[15]*(P[0][1]*SPP[4] + P[1][1]*SPP[5] - P[2][1]*SPP[10] + P[9][1]*SPP[20]) + SPP[14]*(P[0][2]*SPP[4] + P[1][2]*SPP[5] - P[2][2]*SPP[10] + P[9][2]*SPP[20]);
nextP[0][5] = P[0][5]*SPP[4] + P[1][5]*SPP[5] - P[2][5]*SPP[10] + P[9][5]*SPP[20] + SPP[12]*(P[0][0]*SPP[4] + P[1][0]*SPP[5] - P[2][0]*SPP[10] + P[9][0]*SPP[20]) + SPP[6]*(P[0][2]*SPP[4] + P[1][2]*SPP[5] - P[2][2]*SPP[10] + P[9][2]*SPP[20]) - SPP[11]*(P[0][1]*SPP[4] + P[1][1]*SPP[5] - P[2][1]*SPP[10] + P[9][1]*SPP[20]) - SPP[13]*(P[0][12]*SPP[4] + P[1][12]*SPP[5] - P[2][12]*SPP[10] + P[9][12]*SPP[20]);
nextP[0][6] = P[0][6]*SPP[4] + P[1][6]*SPP[5] - P[2][6]*SPP[10] + P[9][6]*SPP[20] + dt*(P[0][3]*SPP[4] + P[1][3]*SPP[5] - P[2][3]*SPP[10] + P[9][3]*SPP[20]);
nextP[0][7] = P[0][7]*SPP[4] + P[1][7]*SPP[5] - P[2][7]*SPP[10] + P[9][7]*SPP[20] + dt*(P[0][4]*SPP[4] + P[1][4]*SPP[5] - P[2][4]*SPP[10] + P[9][4]*SPP[20]);
nextP[0][8] = P[0][8]*SPP[4] + P[1][8]*SPP[5] - P[2][8]*SPP[10] + P[9][8]*SPP[20] + dt*(P[0][5]*SPP[4] + P[1][5]*SPP[5] - P[2][5]*SPP[10] + P[9][5]*SPP[20]);
nextP[0][9] = P[0][9]*SPP[4] + P[1][9]*SPP[5] - P[2][9]*SPP[10] + P[9][9]*SPP[20];
nextP[0][10] = P[0][10]*SPP[4] + P[1][10]*SPP[5] - P[2][10]*SPP[10] + P[9][10]*SPP[20];
nextP[0][11] = P[0][11]*SPP[4] + P[1][11]*SPP[5] - P[2][11]*SPP[10] + P[9][11]*SPP[20];
nextP[0][12] = P[0][12]*SPP[4] + P[1][12]*SPP[5] - P[2][12]*SPP[10] + P[9][12]*SPP[20];
nextP[0][13] = P[0][13]*SPP[4] + P[1][13]*SPP[5] - P[2][13]*SPP[10] + P[9][13]*SPP[20];
nextP[0][14] = P[0][14]*SPP[4] + P[1][14]*SPP[5] - P[2][14]*SPP[10] + P[9][14]*SPP[20];
nextP[0][15] = P[0][15]*SPP[4] + P[1][15]*SPP[5] - P[2][15]*SPP[10] + P[9][15]*SPP[20];
nextP[0][16] = P[0][16]*SPP[4] + P[1][16]*SPP[5] - P[2][16]*SPP[10] + P[9][16]*SPP[20];
nextP[0][17] = P[0][17]*SPP[4] + P[1][17]*SPP[5] - P[2][17]*SPP[10] + P[9][17]*SPP[20];
nextP[0][18] = P[0][18]*SPP[4] + P[1][18]*SPP[5] - P[2][18]*SPP[10] + P[9][18]*SPP[20];
nextP[0][19] = P[0][19]*SPP[4] + P[1][19]*SPP[5] - P[2][19]*SPP[10] + P[9][19]*SPP[20];
nextP[0][20] = P[0][20]*SPP[4] + P[1][20]*SPP[5] - P[2][20]*SPP[10] + P[9][20]*SPP[20];
nextP[1][0] = SPP[4]*(P[1][0]*SPP[3] - P[0][0]*SPP[2] + P[2][0]*SPP[9] + P[10][0]*SPP[20]) + SPP[5]*(P[1][1]*SPP[3] - P[0][1]*SPP[2] + P[2][1]*SPP[9] + P[10][1]*SPP[20]) - SPP[10]*(P[1][2]*SPP[3] - P[0][2]*SPP[2] + P[2][2]*SPP[9] + P[10][2]*SPP[20]) + SPP[20]*(P[1][9]*SPP[3] - P[0][9]*SPP[2] + P[2][9]*SPP[9] + P[10][9]*SPP[20]);
nextP[1][1] = dayNoise*SQ[3] - SPP[2]*(P[1][0]*SPP[3] - P[0][0]*SPP[2] + P[2][0]*SPP[9] + P[10][0]*SPP[20]) + SPP[3]*(P[1][1]*SPP[3] - P[0][1]*SPP[2] + P[2][1]*SPP[9] + P[10][1]*SPP[20]) + SPP[9]*(P[1][2]*SPP[3] - P[0][2]*SPP[2] + P[2][2]*SPP[9] + P[10][2]*SPP[20]) + SPP[20]*(P[1][10]*SPP[3] - P[0][10]*SPP[2] + P[2][10]*SPP[9] + P[10][10]*SPP[20]);
nextP[1][2] = SPP[0]*(P[1][0]*SPP[3] - P[0][0]*SPP[2] + P[2][0]*SPP[9] + P[10][0]*SPP[20]) - SPP[1]*(P[1][1]*SPP[3] - P[0][1]*SPP[2] + P[2][1]*SPP[9] + P[10][1]*SPP[20]) + SPP[8]*(P[1][2]*SPP[3] - P[0][2]*SPP[2] + P[2][2]*SPP[9] + P[10][2]*SPP[20]) + SPP[20]*(P[1][11]*SPP[3] - P[0][11]*SPP[2] + P[2][11]*SPP[9] + P[10][11]*SPP[20]);
nextP[1][3] = P[1][3]*SPP[3] - P[0][3]*SPP[2] + P[2][3]*SPP[9] + P[10][3]*SPP[20] + SPP[7]*(P[1][0]*SPP[3] - P[0][0]*SPP[2] + P[2][0]*SPP[9] + P[10][0]*SPP[20]) - SPP[16]*(P[1][2]*SPP[3] - P[0][2]*SPP[2] + P[2][2]*SPP[9] + P[10][2]*SPP[20]) - SPP[19]*(P[1][12]*SPP[3] - P[0][12]*SPP[2] + P[2][12]*SPP[9] + P[10][12]*SPP[20]) + (SF[16]*SF[20] - dvx*SPP[19])*(P[1][1]*SPP[3] - P[0][1]*SPP[2] + P[2][1]*SPP[9] + P[10][1]*SPP[20]);
nextP[1][4] = P[1][4]*SPP[3] - P[0][4]*SPP[2] + P[2][4]*SPP[9] + P[10][4]*SPP[20] + SF[19]*(P[1][12]*SPP[3] - P[0][12]*SPP[2] + P[2][12]*SPP[9] + P[10][12]*SPP[20]) - SPP[18]*(P[1][0]*SPP[3] - P[0][0]*SPP[2] + P[2][0]*SPP[9] + P[10][0]*SPP[20]) + SPP[15]*(P[1][1]*SPP[3] - P[0][1]*SPP[2] + P[2][1]*SPP[9] + P[10][1]*SPP[20]) + SPP[14]*(P[1][2]*SPP[3] - P[0][2]*SPP[2] + P[2][2]*SPP[9] + P[10][2]*SPP[20]);
nextP[1][5] = P[1][5]*SPP[3] - P[0][5]*SPP[2] + P[2][5]*SPP[9] + P[10][5]*SPP[20] + SPP[12]*(P[1][0]*SPP[3] - P[0][0]*SPP[2] + P[2][0]*SPP[9] + P[10][0]*SPP[20]) + SPP[6]*(P[1][2]*SPP[3] - P[0][2]*SPP[2] + P[2][2]*SPP[9] + P[10][2]*SPP[20]) - SPP[11]*(P[1][1]*SPP[3] - P[0][1]*SPP[2] + P[2][1]*SPP[9] + P[10][1]*SPP[20]) - SPP[13]*(P[1][12]*SPP[3] - P[0][12]*SPP[2] + P[2][12]*SPP[9] + P[10][12]*SPP[20]);
nextP[1][6] = P[1][6]*SPP[3] - P[0][6]*SPP[2] + P[2][6]*SPP[9] + P[10][6]*SPP[20] + dt*(P[1][3]*SPP[3] - P[0][3]*SPP[2] + P[2][3]*SPP[9] + P[10][3]*SPP[20]);
nextP[1][7] = P[1][7]*SPP[3] - P[0][7]*SPP[2] + P[2][7]*SPP[9] + P[10][7]*SPP[20] + dt*(P[1][4]*SPP[3] - P[0][4]*SPP[2] + P[2][4]*SPP[9] + P[10][4]*SPP[20]);
nextP[1][8] = P[1][8]*SPP[3] - P[0][8]*SPP[2] + P[2][8]*SPP[9] + P[10][8]*SPP[20] + dt*(P[1][5]*SPP[3] - P[0][5]*SPP[2] + P[2][5]*SPP[9] + P[10][5]*SPP[20]);
nextP[1][9] = P[1][9]*SPP[3] - P[0][9]*SPP[2] + P[2][9]*SPP[9] + P[10][9]*SPP[20];
nextP[1][10] = P[1][10]*SPP[3] - P[0][10]*SPP[2] + P[2][10]*SPP[9] + P[10][10]*SPP[20];
nextP[1][11] = P[1][11]*SPP[3] - P[0][11]*SPP[2] + P[2][11]*SPP[9] + P[10][11]*SPP[20];
nextP[1][12] = P[1][12]*SPP[3] - P[0][12]*SPP[2] + P[2][12]*SPP[9] + P[10][12]*SPP[20];
nextP[1][13] = P[1][13]*SPP[3] - P[0][13]*SPP[2] + P[2][13]*SPP[9] + P[10][13]*SPP[20];
nextP[1][14] = P[1][14]*SPP[3] - P[0][14]*SPP[2] + P[2][14]*SPP[9] + P[10][14]*SPP[20];
nextP[1][15] = P[1][15]*SPP[3] - P[0][15]*SPP[2] + P[2][15]*SPP[9] + P[10][15]*SPP[20];
nextP[1][16] = P[1][16]*SPP[3] - P[0][16]*SPP[2] + P[2][16]*SPP[9] + P[10][16]*SPP[20];
nextP[1][17] = P[1][17]*SPP[3] - P[0][17]*SPP[2] + P[2][17]*SPP[9] + P[10][17]*SPP[20];
nextP[1][18] = P[1][18]*SPP[3] - P[0][18]*SPP[2] + P[2][18]*SPP[9] + P[10][18]*SPP[20];
nextP[1][19] = P[1][19]*SPP[3] - P[0][19]*SPP[2] + P[2][19]*SPP[9] + P[10][19]*SPP[20];
nextP[1][20] = P[1][20]*SPP[3] - P[0][20]*SPP[2] + P[2][20]*SPP[9] + P[10][20]*SPP[20];
nextP[2][0] = SPP[4]*(P[0][0]*SPP[0] - P[1][0]*SPP[1] + P[2][0]*SPP[8] + P[11][0]*SPP[20]) + SPP[5]*(P[0][1]*SPP[0] - P[1][1]*SPP[1] + P[2][1]*SPP[8] + P[11][1]*SPP[20]) - SPP[10]*(P[0][2]*SPP[0] - P[1][2]*SPP[1] + P[2][2]*SPP[8] + P[11][2]*SPP[20]) + SPP[20]*(P[0][9]*SPP[0] - P[1][9]*SPP[1] + P[2][9]*SPP[8] + P[11][9]*SPP[20]);
nextP[2][1] = SPP[3]*(P[0][1]*SPP[0] - P[1][1]*SPP[1] + P[2][1]*SPP[8] + P[11][1]*SPP[20]) - SPP[2]*(P[0][0]*SPP[0] - P[1][0]*SPP[1] + P[2][0]*SPP[8] + P[11][0]*SPP[20]) + SPP[9]*(P[0][2]*SPP[0] - P[1][2]*SPP[1] + P[2][2]*SPP[8] + P[11][2]*SPP[20]) + SPP[20]*(P[0][10]*SPP[0] - P[1][10]*SPP[1] + P[2][10]*SPP[8] + P[11][10]*SPP[20]);
nextP[2][2] = dazNoise*SQ[3] + SPP[0]*(P[0][0]*SPP[0] - P[1][0]*SPP[1] + P[2][0]*SPP[8] + P[11][0]*SPP[20]) - SPP[1]*(P[0][1]*SPP[0] - P[1][1]*SPP[1] + P[2][1]*SPP[8] + P[11][1]*SPP[20]) + SPP[8]*(P[0][2]*SPP[0] - P[1][2]*SPP[1] + P[2][2]*SPP[8] + P[11][2]*SPP[20]) + SPP[20]*(P[0][11]*SPP[0] - P[1][11]*SPP[1] + P[2][11]*SPP[8] + P[11][11]*SPP[20]);
nextP[2][3] = P[0][3]*SPP[0] - P[1][3]*SPP[1] + P[2][3]*SPP[8] + P[11][3]*SPP[20] + SPP[7]*(P[0][0]*SPP[0] - P[1][0]*SPP[1] + P[2][0]*SPP[8] + P[11][0]*SPP[20]) - SPP[16]*(P[0][2]*SPP[0] - P[1][2]*SPP[1] + P[2][2]*SPP[8] + P[11][2]*SPP[20]) - SPP[19]*(P[0][12]*SPP[0] - P[1][12]*SPP[1] + P[2][12]*SPP[8] + P[11][12]*SPP[20]) + (SF[16]*SF[20] - dvx*SPP[19])*(P[0][1]*SPP[0] - P[1][1]*SPP[1] + P[2][1]*SPP[8] + P[11][1]*SPP[20]);
nextP[2][4] = P[0][4]*SPP[0] - P[1][4]*SPP[1] + P[2][4]*SPP[8] + P[11][4]*SPP[20] + SF[19]*(P[0][12]*SPP[0] - P[1][12]*SPP[1] + P[2][12]*SPP[8] + P[11][12]*SPP[20]) - SPP[18]*(P[0][0]*SPP[0] - P[1][0]*SPP[1] + P[2][0]*SPP[8] + P[11][0]*SPP[20]) + SPP[15]*(P[0][1]*SPP[0] - P[1][1]*SPP[1] + P[2][1]*SPP[8] + P[11][1]*SPP[20]) + SPP[14]*(P[0][2]*SPP[0] - P[1][2]*SPP[1] + P[2][2]*SPP[8] + P[11][2]*SPP[20]);
nextP[2][5] = P[0][5]*SPP[0] - P[1][5]*SPP[1] + P[2][5]*SPP[8] + P[11][5]*SPP[20] + SPP[12]*(P[0][0]*SPP[0] - P[1][0]*SPP[1] + P[2][0]*SPP[8] + P[11][0]*SPP[20]) + SPP[6]*(P[0][2]*SPP[0] - P[1][2]*SPP[1] + P[2][2]*SPP[8] + P[11][2]*SPP[20]) - SPP[11]*(P[0][1]*SPP[0] - P[1][1]*SPP[1] + P[2][1]*SPP[8] + P[11][1]*SPP[20]) - SPP[13]*(P[0][12]*SPP[0] - P[1][12]*SPP[1] + P[2][12]*SPP[8] + P[11][12]*SPP[20]);
nextP[2][6] = P[0][6]*SPP[0] - P[1][6]*SPP[1] + P[2][6]*SPP[8] + P[11][6]*SPP[20] + dt*(P[0][3]*SPP[0] - P[1][3]*SPP[1] + P[2][3]*SPP[8] + P[11][3]*SPP[20]);
nextP[2][7] = P[0][7]*SPP[0] - P[1][7]*SPP[1] + P[2][7]*SPP[8] + P[11][7]*SPP[20] + dt*(P[0][4]*SPP[0] - P[1][4]*SPP[1] + P[2][4]*SPP[8] + P[11][4]*SPP[20]);
nextP[2][8] = P[0][8]*SPP[0] - P[1][8]*SPP[1] + P[2][8]*SPP[8] + P[11][8]*SPP[20] + dt*(P[0][5]*SPP[0] - P[1][5]*SPP[1] + P[2][5]*SPP[8] + P[11][5]*SPP[20]);
nextP[2][9] = P[0][9]*SPP[0] - P[1][9]*SPP[1] + P[2][9]*SPP[8] + P[11][9]*SPP[20];
nextP[2][10] = P[0][10]*SPP[0] - P[1][10]*SPP[1] + P[2][10]*SPP[8] + P[11][10]*SPP[20];
nextP[2][11] = P[0][11]*SPP[0] - P[1][11]*SPP[1] + P[2][11]*SPP[8] + P[11][11]*SPP[20];
nextP[2][12] = P[0][12]*SPP[0] - P[1][12]*SPP[1] + P[2][12]*SPP[8] + P[11][12]*SPP[20];
nextP[2][13] = P[0][13]*SPP[0] - P[1][13]*SPP[1] + P[2][13]*SPP[8] + P[11][13]*SPP[20];
nextP[2][14] = P[0][14]*SPP[0] - P[1][14]*SPP[1] + P[2][14]*SPP[8] + P[11][14]*SPP[20];
nextP[2][15] = P[0][15]*SPP[0] - P[1][15]*SPP[1] + P[2][15]*SPP[8] + P[11][15]*SPP[20];
nextP[2][16] = P[0][16]*SPP[0] - P[1][16]*SPP[1] + P[2][16]*SPP[8] + P[11][16]*SPP[20];
nextP[2][17] = P[0][17]*SPP[0] - P[1][17]*SPP[1] + P[2][17]*SPP[8] + P[11][17]*SPP[20];
nextP[2][18] = P[0][18]*SPP[0] - P[1][18]*SPP[1] + P[2][18]*SPP[8] + P[11][18]*SPP[20];
nextP[2][19] = P[0][19]*SPP[0] - P[1][19]*SPP[1] + P[2][19]*SPP[8] + P[11][19]*SPP[20];
nextP[2][20] = P[0][20]*SPP[0] - P[1][20]*SPP[1] + P[2][20]*SPP[8] + P[11][20]*SPP[20];
nextP[3][0] = SPP[4]*(P[3][0] + P[0][0]*SPP[7] - P[2][0]*SPP[16] - P[12][0]*SPP[19] + P[1][0]*(SF[16]*SF[20] - dvx*SPP[19])) + SPP[5]*(P[3][1] + P[0][1]*SPP[7] - P[2][1]*SPP[16] - P[12][1]*SPP[19] + P[1][1]*(SF[16]*SF[20] - dvx*SPP[19])) - SPP[10]*(P[3][2] + P[0][2]*SPP[7] - P[2][2]*SPP[16] - P[12][2]*SPP[19] + P[1][2]*(SF[16]*SF[20] - dvx*SPP[19])) + SPP[20]*(P[3][9] + P[0][9]*SPP[7] - P[2][9]*SPP[16] - P[12][9]*SPP[19] + P[1][9]*(SF[16]*SF[20] - dvx*SPP[19]));
nextP[3][1] = SPP[3]*(P[3][1] + P[0][1]*SPP[7] - P[2][1]*SPP[16] - P[12][1]*SPP[19] + P[1][1]*(SF[16]*SF[20] - dvx*SPP[19])) - SPP[2]*(P[3][0] + P[0][0]*SPP[7] - P[2][0]*SPP[16] - P[12][0]*SPP[19] + P[1][0]*(SF[16]*SF[20] - dvx*SPP[19])) + SPP[9]*(P[3][2] + P[0][2]*SPP[7] - P[2][2]*SPP[16] - P[12][2]*SPP[19] + P[1][2]*(SF[16]*SF[20] - dvx*SPP[19])) + SPP[20]*(P[3][10] + P[0][10]*SPP[7] - P[2][10]*SPP[16] - P[12][10]*SPP[19] + P[1][10]*(SF[16]*SF[20] - dvx*SPP[19]));
nextP[3][2] = SPP[0]*(P[3][0] + P[0][0]*SPP[7] - P[2][0]*SPP[16] - P[12][0]*SPP[19] + P[1][0]*(SF[16]*SF[20] - dvx*SPP[19])) - SPP[1]*(P[3][1] + P[0][1]*SPP[7] - P[2][1]*SPP[16] - P[12][1]*SPP[19] + P[1][1]*(SF[16]*SF[20] - dvx*SPP[19])) + SPP[8]*(P[3][2] + P[0][2]*SPP[7] - P[2][2]*SPP[16] - P[12][2]*SPP[19] + P[1][2]*(SF[16]*SF[20] - dvx*SPP[19])) + SPP[20]*(P[3][11] + P[0][11]*SPP[7] - P[2][11]*SPP[16] - P[12][11]*SPP[19] + P[1][11]*(SF[16]*SF[20] - dvx*SPP[19]));
nextP[3][3] = P[3][3] + P[0][3]*SPP[7] + P[1][3]*SPP[17] - P[2][3]*SPP[16] - P[12][3]*SPP[19] + dvyNoise*sq(SQ[6] - 2*q0*q3) + dvzNoise*sq(SQ[5] + 2*q0*q2) + SPP[7]*(P[3][0] + P[0][0]*SPP[7] + P[1][0]*SPP[17] - P[2][0]*SPP[16] - P[12][0]*SPP[19]) + SPP[17]*(P[3][1] + P[0][1]*SPP[7] + P[1][1]*SPP[17] - P[2][1]*SPP[16] - P[12][1]*SPP[19]) - SPP[16]*(P[3][2] + P[0][2]*SPP[7] + P[1][2]*SPP[17] - P[2][2]*SPP[16] - P[12][2]*SPP[19]) + dvxNoise*sq(SG[1] + SG[2] - SG[3] - SQ[7]) - SPP[19]*(P[3][12] + P[0][12]*SPP[7] - P[2][12]*SPP[16] - P[12][12]*SPP[19] + P[1][12]*(SF[16]*SF[20] - dvx*SPP[19]));
nextP[3][4] = P[3][4] + SQ[2] + P[0][4]*SPP[7] + P[1][4]*SPP[17] - P[2][4]*SPP[16] - P[12][4]*SPP[19] + SF[19]*(P[3][12] + P[0][12]*SPP[7] + P[1][12]*SPP[17] - P[2][12]*SPP[16] - P[12][12]*SPP[19]) - SPP[18]*(P[3][0] + P[0][0]*SPP[7] + P[1][0]*SPP[17] - P[2][0]*SPP[16] - P[12][0]*SPP[19]) + SPP[15]*(P[3][1] + P[0][1]*SPP[7] + P[1][1]*SPP[17] - P[2][1]*SPP[16] - P[12][1]*SPP[19]) + SPP[14]*(P[3][2] + P[0][2]*SPP[7] + P[1][2]*SPP[17] - P[2][2]*SPP[16] - P[12][2]*SPP[19]);
nextP[3][5] = P[3][5] + SQ[1] + P[0][5]*SPP[7] + P[1][5]*SPP[17] - P[2][5]*SPP[16] - P[12][5]*SPP[19] + SPP[12]*(P[3][0] + P[0][0]*SPP[7] + P[1][0]*SPP[17] - P[2][0]*SPP[16] - P[12][0]*SPP[19]) + SPP[6]*(P[3][2] + P[0][2]*SPP[7] + P[1][2]*SPP[17] - P[2][2]*SPP[16] - P[12][2]*SPP[19]) - SPP[11]*(P[3][1] + P[0][1]*SPP[7] + P[1][1]*SPP[17] - P[2][1]*SPP[16] - P[12][1]*SPP[19]) - SPP[13]*(P[3][12] + P[0][12]*SPP[7] + P[1][12]*SPP[17] - P[2][12]*SPP[16] - P[12][12]*SPP[19]);
nextP[3][6] = P[3][6] + P[0][6]*SPP[7] + P[1][6]*SPP[17] - P[2][6]*SPP[16] - P[12][6]*SPP[19] + dt*(P[3][3] + P[0][3]*SPP[7] + P[1][3]*SPP[17] - P[2][3]*SPP[16] - P[12][3]*SPP[19]);
nextP[3][7] = P[3][7] + P[0][7]*SPP[7] + P[1][7]*SPP[17] - P[2][7]*SPP[16] - P[12][7]*SPP[19] + dt*(P[3][4] + P[0][4]*SPP[7] + P[1][4]*SPP[17] - P[2][4]*SPP[16] - P[12][4]*SPP[19]);
nextP[3][8] = P[3][8] + P[0][8]*SPP[7] + P[1][8]*SPP[17] - P[2][8]*SPP[16] - P[12][8]*SPP[19] + dt*(P[3][5] + P[0][5]*SPP[7] + P[1][5]*SPP[17] - P[2][5]*SPP[16] - P[12][5]*SPP[19]);
nextP[3][9] = P[3][9] + P[0][9]*SPP[7] + P[1][9]*SPP[17] - P[2][9]*SPP[16] - P[12][9]*SPP[19];
nextP[3][10] = P[3][10] + P[0][10]*SPP[7] + P[1][10]*SPP[17] - P[2][10]*SPP[16] - P[12][10]*SPP[19];
nextP[3][11] = P[3][11] + P[0][11]*SPP[7] + P[1][11]*SPP[17] - P[2][11]*SPP[16] - P[12][11]*SPP[19];
nextP[3][12] = P[3][12] + P[0][12]*SPP[7] + P[1][12]*SPP[17] - P[2][12]*SPP[16] - P[12][12]*SPP[19];
nextP[3][13] = P[3][13] + P[0][13]*SPP[7] + P[1][13]*SPP[17] - P[2][13]*SPP[16] - P[12][13]*SPP[19];
nextP[3][14] = P[3][14] + P[0][14]*SPP[7] + P[1][14]*SPP[17] - P[2][14]*SPP[16] - P[12][14]*SPP[19];
nextP[3][15] = P[3][15] + P[0][15]*SPP[7] + P[1][15]*SPP[17] - P[2][15]*SPP[16] - P[12][15]*SPP[19];
nextP[3][16] = P[3][16] + P[0][16]*SPP[7] + P[1][16]*SPP[17] - P[2][16]*SPP[16] - P[12][16]*SPP[19];
nextP[3][17] = P[3][17] + P[0][17]*SPP[7] + P[1][17]*SPP[17] - P[2][17]*SPP[16] - P[12][17]*SPP[19];
nextP[3][18] = P[3][18] + P[0][18]*SPP[7] + P[1][18]*SPP[17] - P[2][18]*SPP[16] - P[12][18]*SPP[19];
nextP[3][19] = P[3][19] + P[0][19]*SPP[7] + P[1][19]*SPP[17] - P[2][19]*SPP[16] - P[12][19]*SPP[19];
nextP[3][20] = P[3][20] + P[0][20]*SPP[7] + P[1][20]*SPP[17] - P[2][20]*SPP[16] - P[12][20]*SPP[19];
nextP[4][0] = SPP[4]*(P[4][0] + P[12][0]*SF[19] - P[0][0]*SPP[18] + P[1][0]*SPP[15] + P[2][0]*SPP[14]) + SPP[5]*(P[4][1] + P[12][1]*SF[19] - P[0][1]*SPP[18] + P[1][1]*SPP[15] + P[2][1]*SPP[14]) - SPP[10]*(P[4][2] + P[12][2]*SF[19] - P[0][2]*SPP[18] + P[1][2]*SPP[15] + P[2][2]*SPP[14]) + SPP[20]*(P[4][9] + P[12][9]*SF[19] - P[0][9]*SPP[18] + P[1][9]*SPP[15] + P[2][9]*SPP[14]);
nextP[4][1] = SPP[3]*(P[4][1] + P[12][1]*SF[19] - P[0][1]*SPP[18] + P[1][1]*SPP[15] + P[2][1]*SPP[14]) - SPP[2]*(P[4][0] + P[12][0]*SF[19] - P[0][0]*SPP[18] + P[1][0]*SPP[15] + P[2][0]*SPP[14]) + SPP[9]*(P[4][2] + P[12][2]*SF[19] - P[0][2]*SPP[18] + P[1][2]*SPP[15] + P[2][2]*SPP[14]) + SPP[20]*(P[4][10] + P[12][10]*SF[19] - P[0][10]*SPP[18] + P[1][10]*SPP[15] + P[2][10]*SPP[14]);
nextP[4][2] = SPP[0]*(P[4][0] + P[12][0]*SF[19] - P[0][0]*SPP[18] + P[1][0]*SPP[15] + P[2][0]*SPP[14]) - SPP[1]*(P[4][1] + P[12][1]*SF[19] - P[0][1]*SPP[18] + P[1][1]*SPP[15] + P[2][1]*SPP[14]) + SPP[8]*(P[4][2] + P[12][2]*SF[19] - P[0][2]*SPP[18] + P[1][2]*SPP[15] + P[2][2]*SPP[14]) + SPP[20]*(P[4][11] + P[12][11]*SF[19] - P[0][11]*SPP[18] + P[1][11]*SPP[15] + P[2][11]*SPP[14]);
nextP[4][3] = P[4][3] + SQ[2] + P[12][3]*SF[19] - P[0][3]*SPP[18] + P[1][3]*SPP[15] + P[2][3]*SPP[14] + SPP[7]*(P[4][0] + P[12][0]*SF[19] - P[0][0]*SPP[18] + P[1][0]*SPP[15] + P[2][0]*SPP[14]) + SPP[17]*(P[4][1] + P[12][1]*SF[19] - P[0][1]*SPP[18] + P[1][1]*SPP[15] + P[2][1]*SPP[14]) - SPP[16]*(P[4][2] + P[12][2]*SF[19] - P[0][2]*SPP[18] + P[1][2]*SPP[15] + P[2][2]*SPP[14]) - SPP[19]*(P[4][12] + P[12][12]*SF[19] - P[0][12]*SPP[18] + P[1][12]*SPP[15] + P[2][12]*SPP[14]);
nextP[4][4] = P[4][4] + P[12][4]*SF[19] - P[0][4]*SPP[18] + P[1][4]*SPP[15] + P[2][4]*SPP[14] + dvxNoise*sq(SQ[6] + 2*q0*q3) + dvzNoise*sq(SQ[4] - 2*q0*q1) + SF[19]*(P[4][12] + P[12][12]*SF[19] - P[0][12]*SPP[18] + P[1][12]*SPP[15] + P[2][12]*SPP[14]) - SPP[18]*(P[4][0] + P[12][0]*SF[19] - P[0][0]*SPP[18] + P[1][0]*SPP[15] + P[2][0]*SPP[14]) + SPP[15]*(P[4][1] + P[12][1]*SF[19] - P[0][1]*SPP[18] + P[1][1]*SPP[15] + P[2][1]*SPP[14]) + SPP[14]*(P[4][2] + P[12][2]*SF[19] - P[0][2]*SPP[18] + P[1][2]*SPP[15] + P[2][2]*SPP[14]) + dvyNoise*sq(SG[1] - SG[2] + SG[3] - SQ[7]);
nextP[4][5] = P[4][5] + SQ[0] + P[12][5]*SF[19] - P[0][5]*SPP[18] + P[1][5]*SPP[15] + P[2][5]*SPP[14] + SPP[12]*(P[4][0] + P[12][0]*SF[19] - P[0][0]*SPP[18] + P[1][0]*SPP[15] + P[2][0]*SPP[14]) + SPP[6]*(P[4][2] + P[12][2]*SF[19] - P[0][2]*SPP[18] + P[1][2]*SPP[15] + P[2][2]*SPP[14]) - SPP[11]*(P[4][1] + P[12][1]*SF[19] - P[0][1]*SPP[18] + P[1][1]*SPP[15] + P[2][1]*SPP[14]) - SPP[13]*(P[4][12] + P[12][12]*SF[19] - P[0][12]*SPP[18] + P[1][12]*SPP[15] + P[2][12]*SPP[14]);
nextP[4][6] = P[4][6] + P[12][6]*SF[19] - P[0][6]*SPP[18] + P[1][6]*SPP[15] + P[2][6]*SPP[14] + dt*(P[4][3] + P[12][3]*SF[19] - P[0][3]*SPP[18] + P[1][3]*SPP[15] + P[2][3]*SPP[14]);
nextP[4][7] = P[4][7] + P[12][7]*SF[19] - P[0][7]*SPP[18] + P[1][7]*SPP[15] + P[2][7]*SPP[14] + dt*(P[4][4] + P[12][4]*SF[19] - P[0][4]*SPP[18] + P[1][4]*SPP[15] + P[2][4]*SPP[14]);
nextP[4][8] = P[4][8] + P[12][8]*SF[19] - P[0][8]*SPP[18] + P[1][8]*SPP[15] + P[2][8]*SPP[14] + dt*(P[4][5] + P[12][5]*SF[19] - P[0][5]*SPP[18] + P[1][5]*SPP[15] + P[2][5]*SPP[14]);
nextP[4][9] = P[4][9] + P[12][9]*SF[19] - P[0][9]*SPP[18] + P[1][9]*SPP[15] + P[2][9]*SPP[14];
nextP[4][10] = P[4][10] + P[12][10]*SF[19] - P[0][10]*SPP[18] + P[1][10]*SPP[15] + P[2][10]*SPP[14];
nextP[4][11] = P[4][11] + P[12][11]*SF[19] - P[0][11]*SPP[18] + P[1][11]*SPP[15] + P[2][11]*SPP[14];
nextP[4][12] = P[4][12] + P[12][12]*SF[19] - P[0][12]*SPP[18] + P[1][12]*SPP[15] + P[2][12]*SPP[14];
nextP[4][13] = P[4][13] + P[12][13]*SF[19] - P[0][13]*SPP[18] + P[1][13]*SPP[15] + P[2][13]*SPP[14];
nextP[4][14] = P[4][14] + P[12][14]*SF[19] - P[0][14]*SPP[18] + P[1][14]*SPP[15] + P[2][14]*SPP[14];
nextP[4][15] = P[4][15] + P[12][15]*SF[19] - P[0][15]*SPP[18] + P[1][15]*SPP[15] + P[2][15]*SPP[14];
nextP[4][16] = P[4][16] + P[12][16]*SF[19] - P[0][16]*SPP[18] + P[1][16]*SPP[15] + P[2][16]*SPP[14];
nextP[4][17] = P[4][17] + P[12][17]*SF[19] - P[0][17]*SPP[18] + P[1][17]*SPP[15] + P[2][17]*SPP[14];
nextP[4][18] = P[4][18] + P[12][18]*SF[19] - P[0][18]*SPP[18] + P[1][18]*SPP[15] + P[2][18]*SPP[14];
nextP[4][19] = P[4][19] + P[12][19]*SF[19] - P[0][19]*SPP[18] + P[1][19]*SPP[15] + P[2][19]*SPP[14];
nextP[4][20] = P[4][20] + P[12][20]*SF[19] - P[0][20]*SPP[18] + P[1][20]*SPP[15] + P[2][20]*SPP[14];
nextP[5][0] = SPP[4]*(P[5][0] + P[0][0]*SPP[12] - P[1][0]*SPP[11] + P[2][0]*SPP[6] - P[12][0]*SPP[13]) + SPP[5]*(P[5][1] + P[0][1]*SPP[12] - P[1][1]*SPP[11] + P[2][1]*SPP[6] - P[12][1]*SPP[13]) - SPP[10]*(P[5][2] + P[0][2]*SPP[12] - P[1][2]*SPP[11] + P[2][2]*SPP[6] - P[12][2]*SPP[13]) + SPP[20]*(P[5][9] + P[0][9]*SPP[12] - P[1][9]*SPP[11] + P[2][9]*SPP[6] - P[12][9]*SPP[13]);
nextP[5][1] = SPP[3]*(P[5][1] + P[0][1]*SPP[12] - P[1][1]*SPP[11] + P[2][1]*SPP[6] - P[12][1]*SPP[13]) - SPP[2]*(P[5][0] + P[0][0]*SPP[12] - P[1][0]*SPP[11] + P[2][0]*SPP[6] - P[12][0]*SPP[13]) + SPP[9]*(P[5][2] + P[0][2]*SPP[12] - P[1][2]*SPP[11] + P[2][2]*SPP[6] - P[12][2]*SPP[13]) + SPP[20]*(P[5][10] + P[0][10]*SPP[12] - P[1][10]*SPP[11] + P[2][10]*SPP[6] - P[12][10]*SPP[13]);
nextP[5][2] = SPP[0]*(P[5][0] + P[0][0]*SPP[12] - P[1][0]*SPP[11] + P[2][0]*SPP[6] - P[12][0]*SPP[13]) - SPP[1]*(P[5][1] + P[0][1]*SPP[12] - P[1][1]*SPP[11] + P[2][1]*SPP[6] - P[12][1]*SPP[13]) + SPP[8]*(P[5][2] + P[0][2]*SPP[12] - P[1][2]*SPP[11] + P[2][2]*SPP[6] - P[12][2]*SPP[13]) + SPP[20]*(P[5][11] + P[0][11]*SPP[12] - P[1][11]*SPP[11] + P[2][11]*SPP[6] - P[12][11]*SPP[13]);
nextP[5][3] = P[5][3] + SQ[1] + P[0][3]*SPP[12] - P[1][3]*SPP[11] + P[2][3]*SPP[6] - P[12][3]*SPP[13] + SPP[7]*(P[5][0] + P[0][0]*SPP[12] - P[1][0]*SPP[11] + P[2][0]*SPP[6] - P[12][0]*SPP[13]) + SPP[17]*(P[5][1] + P[0][1]*SPP[12] - P[1][1]*SPP[11] + P[2][1]*SPP[6] - P[12][1]*SPP[13]) - SPP[16]*(P[5][2] + P[0][2]*SPP[12] - P[1][2]*SPP[11] + P[2][2]*SPP[6] - P[12][2]*SPP[13]) - SPP[19]*(P[5][12] + P[0][12]*SPP[12] - P[1][12]*SPP[11] + P[2][12]*SPP[6] - P[12][12]*SPP[13]);
nextP[5][4] = P[5][4] + SQ[0] + P[0][4]*SPP[12] - P[1][4]*SPP[11] + P[2][4]*SPP[6] - P[12][4]*SPP[13] + SF[19]*(P[5][12] + P[0][12]*SPP[12] - P[1][12]*SPP[11] + P[2][12]*SPP[6] - P[12][12]*SPP[13]) - SPP[18]*(P[5][0] + P[0][0]*SPP[12] - P[1][0]*SPP[11] + P[2][0]*SPP[6] - P[12][0]*SPP[13]) + SPP[15]*(P[5][1] + P[0][1]*SPP[12] - P[1][1]*SPP[11] + P[2][1]*SPP[6] - P[12][1]*SPP[13]) + SPP[14]*(P[5][2] + P[0][2]*SPP[12] - P[1][2]*SPP[11] + P[2][2]*SPP[6] - P[12][2]*SPP[13]);
nextP[5][5] = P[5][5] + P[0][5]*SPP[12] - P[1][5]*SPP[11] + P[2][5]*SPP[6] - P[12][5]*SPP[13] + dvxNoise*sq(SQ[5] - 2*q0*q2) + dvyNoise*sq(SQ[4] + 2*q0*q1) + SPP[12]*(P[5][0] + P[0][0]*SPP[12] - P[1][0]*SPP[11] + P[2][0]*SPP[6] - P[12][0]*SPP[13]) + SPP[6]*(P[5][2] + P[0][2]*SPP[12] - P[1][2]*SPP[11] + P[2][2]*SPP[6] - P[12][2]*SPP[13]) - SPP[11]*(P[5][1] + P[0][1]*SPP[12] - P[1][1]*SPP[11] + P[2][1]*SPP[6] - P[12][1]*SPP[13]) - SPP[13]*(P[5][12] + P[0][12]*SPP[12] - P[1][12]*SPP[11] + P[2][12]*SPP[6] - P[12][12]*SPP[13]) + dvzNoise*sq(SG[1] - SG[2] - SG[3] + SQ[7]);
nextP[5][6] = P[5][6] + P[0][6]*SPP[12] - P[1][6]*SPP[11] + P[2][6]*SPP[6] - P[12][6]*SPP[13] + dt*(P[5][3] + P[0][3]*SPP[12] - P[1][3]*SPP[11] + P[2][3]*SPP[6] - P[12][3]*SPP[13]);
nextP[5][7] = P[5][7] + P[0][7]*SPP[12] - P[1][7]*SPP[11] + P[2][7]*SPP[6] - P[12][7]*SPP[13] + dt*(P[5][4] + P[0][4]*SPP[12] - P[1][4]*SPP[11] + P[2][4]*SPP[6] - P[12][4]*SPP[13]);
nextP[5][8] = P[5][8] + P[0][8]*SPP[12] - P[1][8]*SPP[11] + P[2][8]*SPP[6] - P[12][8]*SPP[13] + dt*(P[5][5] + P[0][5]*SPP[12] - P[1][5]*SPP[11] + P[2][5]*SPP[6] - P[12][5]*SPP[13]);
nextP[5][9] = P[5][9] + P[0][9]*SPP[12] - P[1][9]*SPP[11] + P[2][9]*SPP[6] - P[12][9]*SPP[13];
nextP[5][10] = P[5][10] + P[0][10]*SPP[12] - P[1][10]*SPP[11] + P[2][10]*SPP[6] - P[12][10]*SPP[13];
nextP[5][11] = P[5][11] + P[0][11]*SPP[12] - P[1][11]*SPP[11] + P[2][11]*SPP[6] - P[12][11]*SPP[13];
nextP[5][12] = P[5][12] + P[0][12]*SPP[12] - P[1][12]*SPP[11] + P[2][12]*SPP[6] - P[12][12]*SPP[13];
nextP[5][13] = P[5][13] + P[0][13]*SPP[12] - P[1][13]*SPP[11] + P[2][13]*SPP[6] - P[12][13]*SPP[13];
nextP[5][14] = P[5][14] + P[0][14]*SPP[12] - P[1][14]*SPP[11] + P[2][14]*SPP[6] - P[12][14]*SPP[13];
nextP[5][15] = P[5][15] + P[0][15]*SPP[12] - P[1][15]*SPP[11] + P[2][15]*SPP[6] - P[12][15]*SPP[13];
nextP[5][16] = P[5][16] + P[0][16]*SPP[12] - P[1][16]*SPP[11] + P[2][16]*SPP[6] - P[12][16]*SPP[13];
nextP[5][17] = P[5][17] + P[0][17]*SPP[12] - P[1][17]*SPP[11] + P[2][17]*SPP[6] - P[12][17]*SPP[13];
nextP[5][18] = P[5][18] + P[0][18]*SPP[12] - P[1][18]*SPP[11] + P[2][18]*SPP[6] - P[12][18]*SPP[13];
nextP[5][19] = P[5][19] + P[0][19]*SPP[12] - P[1][19]*SPP[11] + P[2][19]*SPP[6] - P[12][19]*SPP[13];
nextP[5][20] = P[5][20] + P[0][20]*SPP[12] - P[1][20]*SPP[11] + P[2][20]*SPP[6] - P[12][20]*SPP[13];
nextP[6][0] = SPP[4]*(P[6][0] + P[3][0]*dt) + SPP[5]*(P[6][1] + P[3][1]*dt) - SPP[10]*(P[6][2] + P[3][2]*dt) + SPP[20]*(P[6][9] + P[3][9]*dt);
nextP[6][1] = SPP[3]*(P[6][1] + P[3][1]*dt) - SPP[2]*(P[6][0] + P[3][0]*dt) + SPP[9]*(P[6][2] + P[3][2]*dt) + SPP[20]*(P[6][10] + P[3][10]*dt);
nextP[6][2] = SPP[0]*(P[6][0] + P[3][0]*dt) - SPP[1]*(P[6][1] + P[3][1]*dt) + SPP[8]*(P[6][2] + P[3][2]*dt) + SPP[20]*(P[6][11] + P[3][11]*dt);
nextP[6][3] = P[6][3] + P[3][3]*dt + SPP[7]*(P[6][0] + P[3][0]*dt) + SPP[17]*(P[6][1] + P[3][1]*dt) - SPP[16]*(P[6][2] + P[3][2]*dt) - SPP[19]*(P[6][12] + P[3][12]*dt);
nextP[6][4] = P[6][4] + P[3][4]*dt + SF[19]*(P[6][12] + P[3][12]*dt) + SPP[15]*(P[6][1] + P[3][1]*dt) + SPP[14]*(P[6][2] + P[3][2]*dt) - SPP[18]*(P[6][0] + P[3][0]*dt);
nextP[6][5] = P[6][5] + P[3][5]*dt + SPP[6]*(P[6][2] + P[3][2]*dt) + SPP[12]*(P[6][0] + P[3][0]*dt) - SPP[11]*(P[6][1] + P[3][1]*dt) - SPP[13]*(P[6][12] + P[3][12]*dt);
nextP[6][6] = P[6][6] + P[3][6]*dt + dt*(P[6][3] + P[3][3]*dt);
nextP[6][7] = P[6][7] + P[3][7]*dt + dt*(P[6][4] + P[3][4]*dt);
nextP[6][8] = P[6][8] + P[3][8]*dt + dt*(P[6][5] + P[3][5]*dt);
nextP[6][9] = P[6][9] + P[3][9]*dt;
nextP[6][10] = P[6][10] + P[3][10]*dt;
nextP[6][11] = P[6][11] + P[3][11]*dt;
nextP[6][12] = P[6][12] + P[3][12]*dt;
nextP[6][13] = P[6][13] + P[3][13]*dt;
nextP[6][14] = P[6][14] + P[3][14]*dt;
nextP[6][15] = P[6][15] + P[3][15]*dt;
nextP[6][16] = P[6][16] + P[3][16]*dt;
nextP[6][17] = P[6][17] + P[3][17]*dt;
nextP[6][18] = P[6][18] + P[3][18]*dt;
nextP[6][19] = P[6][19] + P[3][19]*dt;
nextP[6][20] = P[6][20] + P[3][20]*dt;
nextP[7][0] = SPP[4]*(P[7][0] + P[4][0]*dt) + SPP[5]*(P[7][1] + P[4][1]*dt) - SPP[10]*(P[7][2] + P[4][2]*dt) + SPP[20]*(P[7][9] + P[4][9]*dt);
nextP[7][1] = SPP[3]*(P[7][1] + P[4][1]*dt) - SPP[2]*(P[7][0] + P[4][0]*dt) + SPP[9]*(P[7][2] + P[4][2]*dt) + SPP[20]*(P[7][10] + P[4][10]*dt);
nextP[7][2] = SPP[0]*(P[7][0] + P[4][0]*dt) - SPP[1]*(P[7][1] + P[4][1]*dt) + SPP[8]*(P[7][2] + P[4][2]*dt) + SPP[20]*(P[7][11] + P[4][11]*dt);
nextP[7][3] = P[7][3] + P[4][3]*dt + SPP[7]*(P[7][0] + P[4][0]*dt) + SPP[17]*(P[7][1] + P[4][1]*dt) - SPP[16]*(P[7][2] + P[4][2]*dt) - SPP[19]*(P[7][12] + P[4][12]*dt);
nextP[7][4] = P[7][4] + P[4][4]*dt + SF[19]*(P[7][12] + P[4][12]*dt) + SPP[15]*(P[7][1] + P[4][1]*dt) + SPP[14]*(P[7][2] + P[4][2]*dt) - SPP[18]*(P[7][0] + P[4][0]*dt);
nextP[7][5] = P[7][5] + P[4][5]*dt + SPP[6]*(P[7][2] + P[4][2]*dt) + SPP[12]*(P[7][0] + P[4][0]*dt) - SPP[11]*(P[7][1] + P[4][1]*dt) - SPP[13]*(P[7][12] + P[4][12]*dt);
nextP[7][6] = P[7][6] + P[4][6]*dt + dt*(P[7][3] + P[4][3]*dt);
nextP[7][7] = P[7][7] + P[4][7]*dt + dt*(P[7][4] + P[4][4]*dt);
nextP[7][8] = P[7][8] + P[4][8]*dt + dt*(P[7][5] + P[4][5]*dt);
nextP[7][9] = P[7][9] + P[4][9]*dt;
nextP[7][10] = P[7][10] + P[4][10]*dt;
nextP[7][11] = P[7][11] + P[4][11]*dt;
nextP[7][12] = P[7][12] + P[4][12]*dt;
nextP[7][13] = P[7][13] + P[4][13]*dt;
nextP[7][14] = P[7][14] + P[4][14]*dt;
nextP[7][15] = P[7][15] + P[4][15]*dt;
nextP[7][16] = P[7][16] + P[4][16]*dt;
nextP[7][17] = P[7][17] + P[4][17]*dt;
nextP[7][18] = P[7][18] + P[4][18]*dt;
nextP[7][19] = P[7][19] + P[4][19]*dt;
nextP[7][20] = P[7][20] + P[4][20]*dt;
nextP[8][0] = SPP[4]*(P[8][0] + P[5][0]*dt) + SPP[5]*(P[8][1] + P[5][1]*dt) - SPP[10]*(P[8][2] + P[5][2]*dt) + SPP[20]*(P[8][9] + P[5][9]*dt);
nextP[8][1] = SPP[3]*(P[8][1] + P[5][1]*dt) - SPP[2]*(P[8][0] + P[5][0]*dt) + SPP[9]*(P[8][2] + P[5][2]*dt) + SPP[20]*(P[8][10] + P[5][10]*dt);
nextP[8][2] = SPP[0]*(P[8][0] + P[5][0]*dt) - SPP[1]*(P[8][1] + P[5][1]*dt) + SPP[8]*(P[8][2] + P[5][2]*dt) + SPP[20]*(P[8][11] + P[5][11]*dt);
nextP[8][3] = P[8][3] + P[5][3]*dt + SPP[7]*(P[8][0] + P[5][0]*dt) + SPP[17]*(P[8][1] + P[5][1]*dt) - SPP[16]*(P[8][2] + P[5][2]*dt) - SPP[19]*(P[8][12] + P[5][12]*dt);
nextP[8][4] = P[8][4] + P[5][4]*dt + SF[19]*(P[8][12] + P[5][12]*dt) + SPP[15]*(P[8][1] + P[5][1]*dt) + SPP[14]*(P[8][2] + P[5][2]*dt) - SPP[18]*(P[8][0] + P[5][0]*dt);
nextP[8][5] = P[8][5] + P[5][5]*dt + SPP[6]*(P[8][2] + P[5][2]*dt) + SPP[12]*(P[8][0] + P[5][0]*dt) - SPP[11]*(P[8][1] + P[5][1]*dt) - SPP[13]*(P[8][12] + P[5][12]*dt);
nextP[8][6] = P[8][6] + P[5][6]*dt + dt*(P[8][3] + P[5][3]*dt);
nextP[8][7] = P[8][7] + P[5][7]*dt + dt*(P[8][4] + P[5][4]*dt);
nextP[8][8] = P[8][8] + P[5][8]*dt + dt*(P[8][5] + P[5][5]*dt);
nextP[8][9] = P[8][9] + P[5][9]*dt;
nextP[8][10] = P[8][10] + P[5][10]*dt;
nextP[8][11] = P[8][11] + P[5][11]*dt;
nextP[8][12] = P[8][12] + P[5][12]*dt;
nextP[8][13] = P[8][13] + P[5][13]*dt;
nextP[8][14] = P[8][14] + P[5][14]*dt;
nextP[8][15] = P[8][15] + P[5][15]*dt;
nextP[8][16] = P[8][16] + P[5][16]*dt;
nextP[8][17] = P[8][17] + P[5][17]*dt;
nextP[8][18] = P[8][18] + P[5][18]*dt;
nextP[8][19] = P[8][19] + P[5][19]*dt;
nextP[8][20] = P[8][20] + P[5][20]*dt;
nextP[9][0] = P[9][0]*SPP[4] + P[9][1]*SPP[5] - P[9][2]*SPP[10] + P[9][9]*SPP[20];
nextP[9][1] = P[9][1]*SPP[3] - P[9][0]*SPP[2] + P[9][2]*SPP[9] + P[9][10]*SPP[20];
nextP[9][2] = P[9][0]*SPP[0] - P[9][1]*SPP[1] + P[9][2]*SPP[8] + P[9][11]*SPP[20];
nextP[9][3] = P[9][3] + P[9][0]*SPP[7] + P[9][1]*SPP[17] - P[9][2]*SPP[16] - P[9][12]*SPP[19];
nextP[9][4] = P[9][4] + P[9][12]*SF[19] + P[9][1]*SPP[15] + P[9][2]*SPP[14] - P[9][0]*SPP[18];
nextP[9][5] = P[9][5] + P[9][2]*SPP[6] + P[9][0]*SPP[12] - P[9][1]*SPP[11] - P[9][12]*SPP[13];
nextP[9][6] = P[9][6] + P[9][3]*dt;
nextP[9][7] = P[9][7] + P[9][4]*dt;
nextP[9][8] = P[9][8] + P[9][5]*dt;
nextP[9][9] = P[9][9];
nextP[9][10] = P[9][10];
nextP[9][11] = P[9][11];
nextP[9][12] = P[9][12];
nextP[9][13] = P[9][13];
nextP[9][14] = P[9][14];
nextP[9][15] = P[9][15];
nextP[9][16] = P[9][16];
nextP[9][17] = P[9][17];
nextP[9][18] = P[9][18];
nextP[9][19] = P[9][19];
nextP[9][20] = P[9][20];
nextP[10][0] = P[10][0]*SPP[4] + P[10][1]*SPP[5] - P[10][2]*SPP[10] + P[10][9]*SPP[20];
nextP[10][1] = P[10][1]*SPP[3] - P[10][0]*SPP[2] + P[10][2]*SPP[9] + P[10][10]*SPP[20];
nextP[10][2] = P[10][0]*SPP[0] - P[10][1]*SPP[1] + P[10][2]*SPP[8] + P[10][11]*SPP[20];
nextP[10][3] = P[10][3] + P[10][0]*SPP[7] + P[10][1]*SPP[17] - P[10][2]*SPP[16] - P[10][12]*SPP[19];
nextP[10][4] = P[10][4] + P[10][12]*SF[19] + P[10][1]*SPP[15] + P[10][2]*SPP[14] - P[10][0]*SPP[18];
nextP[10][5] = P[10][5] + P[10][2]*SPP[6] + P[10][0]*SPP[12] - P[10][1]*SPP[11] - P[10][12]*SPP[13];
nextP[10][6] = P[10][6] + P[10][3]*dt;
nextP[10][7] = P[10][7] + P[10][4]*dt;
nextP[10][8] = P[10][8] + P[10][5]*dt;
nextP[10][9] = P[10][9];
nextP[10][10] = P[10][10];
nextP[10][11] = P[10][11];
nextP[10][12] = P[10][12];
nextP[10][13] = P[10][13];
nextP[10][14] = P[10][14];
nextP[10][15] = P[10][15];
nextP[10][16] = P[10][16];
nextP[10][17] = P[10][17];
nextP[10][18] = P[10][18];
nextP[10][19] = P[10][19];
nextP[10][20] = P[10][20];
nextP[11][0] = P[11][0]*SPP[4] + P[11][1]*SPP[5] - P[11][2]*SPP[10] + P[11][9]*SPP[20];
nextP[11][1] = P[11][1]*SPP[3] - P[11][0]*SPP[2] + P[11][2]*SPP[9] + P[11][10]*SPP[20];
nextP[11][2] = P[11][0]*SPP[0] - P[11][1]*SPP[1] + P[11][2]*SPP[8] + P[11][11]*SPP[20];
nextP[11][3] = P[11][3] + P[11][0]*SPP[7] + P[11][1]*SPP[17] - P[11][2]*SPP[16] - P[11][12]*SPP[19];
nextP[11][4] = P[11][4] + P[11][12]*SF[19] + P[11][1]*SPP[15] + P[11][2]*SPP[14] - P[11][0]*SPP[18];
nextP[11][5] = P[11][5] + P[11][2]*SPP[6] + P[11][0]*SPP[12] - P[11][1]*SPP[11] - P[11][12]*SPP[13];
nextP[11][6] = P[11][6] + P[11][3]*dt;
nextP[11][7] = P[11][7] + P[11][4]*dt;
nextP[11][8] = P[11][8] + P[11][5]*dt;
nextP[11][9] = P[11][9];
nextP[11][10] = P[11][10];
nextP[11][11] = P[11][11];
nextP[11][12] = P[11][12];
nextP[11][13] = P[11][13];
nextP[11][14] = P[11][14];
nextP[11][15] = P[11][15];
nextP[11][16] = P[11][16];
nextP[11][17] = P[11][17];
nextP[11][18] = P[11][18];
nextP[11][19] = P[11][19];
nextP[11][20] = P[11][20];
nextP[12][0] = P[12][0]*SPP[4] + P[12][1]*SPP[5] - P[12][2]*SPP[10] + P[12][9]*SPP[20];
nextP[12][1] = P[12][1]*SPP[3] - P[12][0]*SPP[2] + P[12][2]*SPP[9] + P[12][10]*SPP[20];
nextP[12][2] = P[12][0]*SPP[0] - P[12][1]*SPP[1] + P[12][2]*SPP[8] + P[12][11]*SPP[20];
nextP[12][3] = P[12][3] + P[12][0]*SPP[7] + P[12][1]*SPP[17] - P[12][2]*SPP[16] - P[12][12]*SPP[19];
nextP[12][4] = P[12][4] + P[12][12]*SF[19] + P[12][1]*SPP[15] + P[12][2]*SPP[14] - P[12][0]*SPP[18];
nextP[12][5] = P[12][5] + P[12][2]*SPP[6] + P[12][0]*SPP[12] - P[12][1]*SPP[11] - P[12][12]*SPP[13];
nextP[12][6] = P[12][6] + P[12][3]*dt;
nextP[12][7] = P[12][7] + P[12][4]*dt;
nextP[12][8] = P[12][8] + P[12][5]*dt;
nextP[12][9] = P[12][9];
nextP[12][10] = P[12][10];
nextP[12][11] = P[12][11];
nextP[12][12] = P[12][12];
nextP[12][13] = P[12][13];
nextP[12][14] = P[12][14];
nextP[12][15] = P[12][15];
nextP[12][16] = P[12][16];
nextP[12][17] = P[12][17];
nextP[12][18] = P[12][18];
nextP[12][19] = P[12][19];
nextP[12][20] = P[12][20];
nextP[13][0] = P[13][0]*SPP[4] + P[13][1]*SPP[5] - P[13][2]*SPP[10] + P[13][9]*SPP[20];
nextP[13][1] = P[13][1]*SPP[3] - P[13][0]*SPP[2] + P[13][2]*SPP[9] + P[13][10]*SPP[20];
nextP[13][2] = P[13][0]*SPP[0] - P[13][1]*SPP[1] + P[13][2]*SPP[8] + P[13][11]*SPP[20];
nextP[13][3] = P[13][3] + P[13][0]*SPP[7] + P[13][1]*SPP[17] - P[13][2]*SPP[16] - P[13][12]*SPP[19];
nextP[13][4] = P[13][4] + P[13][12]*SF[19] + P[13][1]*SPP[15] + P[13][2]*SPP[14] - P[13][0]*SPP[18];
nextP[13][5] = P[13][5] + P[13][2]*SPP[6] + P[13][0]*SPP[12] - P[13][1]*SPP[11] - P[13][12]*SPP[13];
nextP[13][6] = P[13][6] + P[13][3]*dt;
nextP[13][7] = P[13][7] + P[13][4]*dt;
nextP[13][8] = P[13][8] + P[13][5]*dt;
nextP[13][9] = P[13][9];
nextP[13][10] = P[13][10];
nextP[13][11] = P[13][11];
nextP[13][12] = P[13][12];
nextP[13][13] = P[13][13];
nextP[13][14] = P[13][14];
nextP[13][15] = P[13][15];
nextP[13][16] = P[13][16];
nextP[13][17] = P[13][17];
nextP[13][18] = P[13][18];
nextP[13][19] = P[13][19];
nextP[13][20] = P[13][20];
nextP[14][0] = P[14][0]*SPP[4] + P[14][1]*SPP[5] - P[14][2]*SPP[10] + P[14][9]*SPP[20];
nextP[14][1] = P[14][1]*SPP[3] - P[14][0]*SPP[2] + P[14][2]*SPP[9] + P[14][10]*SPP[20];
nextP[14][2] = P[14][0]*SPP[0] - P[14][1]*SPP[1] + P[14][2]*SPP[8] + P[14][11]*SPP[20];
nextP[14][3] = P[14][3] + P[14][0]*SPP[7] + P[14][1]*SPP[17] - P[14][2]*SPP[16] - P[14][12]*SPP[19];
nextP[14][4] = P[14][4] + P[14][12]*SF[19] + P[14][1]*SPP[15] + P[14][2]*SPP[14] - P[14][0]*SPP[18];
nextP[14][5] = P[14][5] + P[14][2]*SPP[6] + P[14][0]*SPP[12] - P[14][1]*SPP[11] - P[14][12]*SPP[13];
nextP[14][6] = P[14][6] + P[14][3]*dt;
nextP[14][7] = P[14][7] + P[14][4]*dt;
nextP[14][8] = P[14][8] + P[14][5]*dt;
nextP[14][9] = P[14][9];
nextP[14][10] = P[14][10];
nextP[14][11] = P[14][11];
nextP[14][12] = P[14][12];
nextP[14][13] = P[14][13];
nextP[14][14] = P[14][14];
nextP[14][15] = P[14][15];
nextP[14][16] = P[14][16];
nextP[14][17] = P[14][17];
nextP[14][18] = P[14][18];
nextP[14][19] = P[14][19];
nextP[14][20] = P[14][20];
nextP[15][0] = P[15][0]*SPP[4] + P[15][1]*SPP[5] - P[15][2]*SPP[10] + P[15][9]*SPP[20];
nextP[15][1] = P[15][1]*SPP[3] - P[15][0]*SPP[2] + P[15][2]*SPP[9] + P[15][10]*SPP[20];
nextP[15][2] = P[15][0]*SPP[0] - P[15][1]*SPP[1] + P[15][2]*SPP[8] + P[15][11]*SPP[20];
nextP[15][3] = P[15][3] + P[15][0]*SPP[7] + P[15][1]*SPP[17] - P[15][2]*SPP[16] - P[15][12]*SPP[19];
nextP[15][4] = P[15][4] + P[15][12]*SF[19] + P[15][1]*SPP[15] + P[15][2]*SPP[14] - P[15][0]*SPP[18];
nextP[15][5] = P[15][5] + P[15][2]*SPP[6] + P[15][0]*SPP[12] - P[15][1]*SPP[11] - P[15][12]*SPP[13];
nextP[15][6] = P[15][6] + P[15][3]*dt;
nextP[15][7] = P[15][7] + P[15][4]*dt;
nextP[15][8] = P[15][8] + P[15][5]*dt;
nextP[15][9] = P[15][9];
nextP[15][10] = P[15][10];
nextP[15][11] = P[15][11];
nextP[15][12] = P[15][12];
nextP[15][13] = P[15][13];
nextP[15][14] = P[15][14];
nextP[15][15] = P[15][15];
nextP[15][16] = P[15][16];
nextP[15][17] = P[15][17];
nextP[15][18] = P[15][18];
nextP[15][19] = P[15][19];
nextP[15][20] = P[15][20];
nextP[16][0] = P[16][0]*SPP[4] + P[16][1]*SPP[5] - P[16][2]*SPP[10] + P[16][9]*SPP[20];
nextP[16][1] = P[16][1]*SPP[3] - P[16][0]*SPP[2] + P[16][2]*SPP[9] + P[16][10]*SPP[20];
nextP[16][2] = P[16][0]*SPP[0] - P[16][1]*SPP[1] + P[16][2]*SPP[8] + P[16][11]*SPP[20];
nextP[16][3] = P[16][3] + P[16][0]*SPP[7] + P[16][1]*SPP[17] - P[16][2]*SPP[16] - P[16][12]*SPP[19];
nextP[16][4] = P[16][4] + P[16][12]*SF[19] + P[16][1]*SPP[15] + P[16][2]*SPP[14] - P[16][0]*SPP[18];
nextP[16][5] = P[16][5] + P[16][2]*SPP[6] + P[16][0]*SPP[12] - P[16][1]*SPP[11] - P[16][12]*SPP[13];
nextP[16][6] = P[16][6] + P[16][3]*dt;
nextP[16][7] = P[16][7] + P[16][4]*dt;
nextP[16][8] = P[16][8] + P[16][5]*dt;
nextP[16][9] = P[16][9];
nextP[16][10] = P[16][10];
nextP[16][11] = P[16][11];
nextP[16][12] = P[16][12];
nextP[16][13] = P[16][13];
nextP[16][14] = P[16][14];
nextP[16][15] = P[16][15];
nextP[16][16] = P[16][16];
nextP[16][17] = P[16][17];
nextP[16][18] = P[16][18];
nextP[16][19] = P[16][19];
nextP[16][20] = P[16][20];
nextP[17][0] = P[17][0]*SPP[4] + P[17][1]*SPP[5] - P[17][2]*SPP[10] + P[17][9]*SPP[20];
nextP[17][1] = P[17][1]*SPP[3] - P[17][0]*SPP[2] + P[17][2]*SPP[9] + P[17][10]*SPP[20];
nextP[17][2] = P[17][0]*SPP[0] - P[17][1]*SPP[1] + P[17][2]*SPP[8] + P[17][11]*SPP[20];
nextP[17][3] = P[17][3] + P[17][0]*SPP[7] + P[17][1]*SPP[17] - P[17][2]*SPP[16] - P[17][12]*SPP[19];
nextP[17][4] = P[17][4] + P[17][12]*SF[19] + P[17][1]*SPP[15] + P[17][2]*SPP[14] - P[17][0]*SPP[18];
nextP[17][5] = P[17][5] + P[17][2]*SPP[6] + P[17][0]*SPP[12] - P[17][1]*SPP[11] - P[17][12]*SPP[13];
nextP[17][6] = P[17][6] + P[17][3]*dt;
nextP[17][7] = P[17][7] + P[17][4]*dt;
nextP[17][8] = P[17][8] + P[17][5]*dt;
nextP[17][9] = P[17][9];
nextP[17][10] = P[17][10];
nextP[17][11] = P[17][11];
nextP[17][12] = P[17][12];
nextP[17][13] = P[17][13];
nextP[17][14] = P[17][14];
nextP[17][15] = P[17][15];
nextP[17][16] = P[17][16];
nextP[17][17] = P[17][17];
nextP[17][18] = P[17][18];
nextP[17][19] = P[17][19];
nextP[17][20] = P[17][20];
nextP[18][0] = P[18][0]*SPP[4] + P[18][1]*SPP[5] - P[18][2]*SPP[10] + P[18][9]*SPP[20];
nextP[18][1] = P[18][1]*SPP[3] - P[18][0]*SPP[2] + P[18][2]*SPP[9] + P[18][10]*SPP[20];
nextP[18][2] = P[18][0]*SPP[0] - P[18][1]*SPP[1] + P[18][2]*SPP[8] + P[18][11]*SPP[20];
nextP[18][3] = P[18][3] + P[18][0]*SPP[7] + P[18][1]*SPP[17] - P[18][2]*SPP[16] - P[18][12]*SPP[19];
nextP[18][4] = P[18][4] + P[18][12]*SF[19] + P[18][1]*SPP[15] + P[18][2]*SPP[14] - P[18][0]*SPP[18];
nextP[18][5] = P[18][5] + P[18][2]*SPP[6] + P[18][0]*SPP[12] - P[18][1]*SPP[11] - P[18][12]*SPP[13];
nextP[18][6] = P[18][6] + P[18][3]*dt;
nextP[18][7] = P[18][7] + P[18][4]*dt;
nextP[18][8] = P[18][8] + P[18][5]*dt;
nextP[18][9] = P[18][9];
nextP[18][10] = P[18][10];
nextP[18][11] = P[18][11];
nextP[18][12] = P[18][12];
nextP[18][13] = P[18][13];
nextP[18][14] = P[18][14];
nextP[18][15] = P[18][15];
nextP[18][16] = P[18][16];
nextP[18][17] = P[18][17];
nextP[18][18] = P[18][18];
nextP[18][19] = P[18][19];
nextP[18][20] = P[18][20];
nextP[19][0] = P[19][0]*SPP[4] + P[19][1]*SPP[5] - P[19][2]*SPP[10] + P[19][9]*SPP[20];
nextP[19][1] = P[19][1]*SPP[3] - P[19][0]*SPP[2] + P[19][2]*SPP[9] + P[19][10]*SPP[20];
nextP[19][2] = P[19][0]*SPP[0] - P[19][1]*SPP[1] + P[19][2]*SPP[8] + P[19][11]*SPP[20];
nextP[19][3] = P[19][3] + P[19][0]*SPP[7] + P[19][1]*SPP[17] - P[19][2]*SPP[16] - P[19][12]*SPP[19];
nextP[19][4] = P[19][4] + P[19][12]*SF[19] + P[19][1]*SPP[15] + P[19][2]*SPP[14] - P[19][0]*SPP[18];
nextP[19][5] = P[19][5] + P[19][2]*SPP[6] + P[19][0]*SPP[12] - P[19][1]*SPP[11] - P[19][12]*SPP[13];
nextP[19][6] = P[19][6] + P[19][3]*dt;
nextP[19][7] = P[19][7] + P[19][4]*dt;
nextP[19][8] = P[19][8] + P[19][5]*dt;
nextP[19][9] = P[19][9];
nextP[19][10] = P[19][10];
nextP[19][11] = P[19][11];
nextP[19][12] = P[19][12];
nextP[19][13] = P[19][13];
nextP[19][14] = P[19][14];
nextP[19][15] = P[19][15];
nextP[19][16] = P[19][16];
nextP[19][17] = P[19][17];
nextP[19][18] = P[19][18];
nextP[19][19] = P[19][19];
nextP[19][20] = P[19][20];
nextP[20][0] = P[20][0]*SPP[4] + P[20][1]*SPP[5] - P[20][2]*SPP[10] + P[20][9]*SPP[20];
nextP[20][1] = P[20][1]*SPP[3] - P[20][0]*SPP[2] + P[20][2]*SPP[9] + P[20][10]*SPP[20];
nextP[20][2] = P[20][0]*SPP[0] - P[20][1]*SPP[1] + P[20][2]*SPP[8] + P[20][11]*SPP[20];
nextP[20][3] = P[20][3] + P[20][0]*SPP[7] + P[20][1]*SPP[17] - P[20][2]*SPP[16] - P[20][12]*SPP[19];
nextP[20][4] = P[20][4] + P[20][12]*SF[19] + P[20][1]*SPP[15] + P[20][2]*SPP[14] - P[20][0]*SPP[18];
nextP[20][5] = P[20][5] + P[20][2]*SPP[6] + P[20][0]*SPP[12] - P[20][1]*SPP[11] - P[20][12]*SPP[13];
nextP[20][6] = P[20][6] + P[20][3]*dt;
nextP[20][7] = P[20][7] + P[20][4]*dt;
nextP[20][8] = P[20][8] + P[20][5]*dt;
nextP[20][9] = P[20][9];
nextP[20][10] = P[20][10];
nextP[20][11] = P[20][11];
nextP[20][12] = P[20][12];
nextP[20][13] = P[20][13];
nextP[20][14] = P[20][14];
nextP[20][15] = P[20][15];
nextP[20][16] = P[20][16];
nextP[20][17] = P[20][17];
nextP[20][18] = P[20][18];
nextP[20][19] = P[20][19];
nextP[20][20] = P[20][20];
float SH_TAS[3][1];
SH_TAS[0] = 1/(sqrt(sq(ve - vwe) + sq(vn - vwn) + sq(vd)));
SH_TAS[1] = (SH_TAS[0]*(2*ve - 2*vwe))/2;
SH_TAS[2] = (SH_TAS[0]*(2*vn - 2*vwn))/2;
float H_TAS[1][21];
H_TAS[0][3] = SH_TAS[2];
H_TAS[0][4] = SH_TAS[1];
H_TAS[0][5] = vd*SH_TAS[0];
H_TAS[0][13] = -SH_TAS[2];
H_TAS[0][14] = -SH_TAS[1];
float SK_TAS[2][1];
SK_TAS[0] = 1/(R_TAS + SH_TAS[2]*(P[3][3]*SH_TAS[2] + P[4][3]*SH_TAS[1] - P[13][3]*SH_TAS[2] - P[14][3]*SH_TAS[1] + P[5][3]*vd*SH_TAS[0]) + SH_TAS[1]*(P[3][4]*SH_TAS[2] + P[4][4]*SH_TAS[1] - P[13][4]*SH_TAS[2] - P[14][4]*SH_TAS[1] + P[5][4]*vd*SH_TAS[0]) - SH_TAS[2]*(P[3][13]*SH_TAS[2] + P[4][13]*SH_TAS[1] - P[13][13]*SH_TAS[2] - P[14][13]*SH_TAS[1] + P[5][13]*vd*SH_TAS[0]) - SH_TAS[1]*(P[3][14]*SH_TAS[2] + P[4][14]*SH_TAS[1] - P[13][14]*SH_TAS[2] - P[14][14]*SH_TAS[1] + P[5][14]*vd*SH_TAS[0]) + vd*SH_TAS[0]*(P[3][5]*SH_TAS[2] + P[4][5]*SH_TAS[1] - P[13][5]*SH_TAS[2] - P[14][5]*SH_TAS[1] + P[5][5]*vd*SH_TAS[0]));
SK_TAS[1] = SH_TAS[1];
float Kfusion[21][1];
float Kfusion[1][1];
Kfusion[0] = SK_TAS[0]*(P[0][3]*SH_TAS[2] - P[0][13]*SH_TAS[2] + P[0][4]*SK_TAS[1] - P[0][14]*SK_TAS[1] + P[0][5]*vd*SH_TAS[0]);
Kfusion[1] = SK_TAS[0]*(P[1][3]*SH_TAS[2] - P[1][13]*SH_TAS[2] + P[1][4]*SK_TAS[1] - P[1][14]*SK_TAS[1] + P[1][5]*vd*SH_TAS[0]);
Kfusion[2] = SK_TAS[0]*(P[2][3]*SH_TAS[2] - P[2][13]*SH_TAS[2] + P[2][4]*SK_TAS[1] - P[2][14]*SK_TAS[1] + P[2][5]*vd*SH_TAS[0]);
Kfusion[3] = SK_TAS[0]*(P[3][3]*SH_TAS[2] - P[3][13]*SH_TAS[2] + P[3][4]*SK_TAS[1] - P[3][14]*SK_TAS[1] + P[3][5]*vd*SH_TAS[0]);
Kfusion[4] = SK_TAS[0]*(P[4][3]*SH_TAS[2] - P[4][13]*SH_TAS[2] + P[4][4]*SK_TAS[1] - P[4][14]*SK_TAS[1] + P[4][5]*vd*SH_TAS[0]);
Kfusion[5] = SK_TAS[0]*(P[5][3]*SH_TAS[2] - P[5][13]*SH_TAS[2] + P[5][4]*SK_TAS[1] - P[5][14]*SK_TAS[1] + P[5][5]*vd*SH_TAS[0]);
Kfusion[6] = SK_TAS[0]*(P[6][3]*SH_TAS[2] - P[6][13]*SH_TAS[2] + P[6][4]*SK_TAS[1] - P[6][14]*SK_TAS[1] + P[6][5]*vd*SH_TAS[0]);
Kfusion[7] = SK_TAS[0]*(P[7][3]*SH_TAS[2] - P[7][13]*SH_TAS[2] + P[7][4]*SK_TAS[1] - P[7][14]*SK_TAS[1] + P[7][5]*vd*SH_TAS[0]);
Kfusion[8] = SK_TAS[0]*(P[8][3]*SH_TAS[2] - P[8][13]*SH_TAS[2] + P[8][4]*SK_TAS[1] - P[8][14]*SK_TAS[1] + P[8][5]*vd*SH_TAS[0]);
Kfusion[9] = SK_TAS[0]*(P[9][3]*SH_TAS[2] - P[9][13]*SH_TAS[2] + P[9][4]*SK_TAS[1] - P[9][14]*SK_TAS[1] + P[9][5]*vd*SH_TAS[0]);
Kfusion[10] = SK_TAS[0]*(P[10][3]*SH_TAS[2] - P[10][13]*SH_TAS[2] + P[10][4]*SK_TAS[1] - P[10][14]*SK_TAS[1] + P[10][5]*vd*SH_TAS[0]);
Kfusion[11] = SK_TAS[0]*(P[11][3]*SH_TAS[2] - P[11][13]*SH_TAS[2] + P[11][4]*SK_TAS[1] - P[11][14]*SK_TAS[1] + P[11][5]*vd*SH_TAS[0]);
Kfusion[12] = SK_TAS[0]*(P[12][3]*SH_TAS[2] - P[12][13]*SH_TAS[2] + P[12][4]*SK_TAS[1] - P[12][14]*SK_TAS[1] + P[12][5]*vd*SH_TAS[0]);
Kfusion[13] = SK_TAS[0]*(P[13][3]*SH_TAS[2] - P[13][13]*SH_TAS[2] + P[13][4]*SK_TAS[1] - P[13][14]*SK_TAS[1] + P[13][5]*vd*SH_TAS[0]);
Kfusion[14] = SK_TAS[0]*(P[14][3]*SH_TAS[2] - P[14][13]*SH_TAS[2] + P[14][4]*SK_TAS[1] - P[14][14]*SK_TAS[1] + P[14][5]*vd*SH_TAS[0]);
Kfusion[15] = SK_TAS[0]*(P[15][3]*SH_TAS[2] - P[15][13]*SH_TAS[2] + P[15][4]*SK_TAS[1] - P[15][14]*SK_TAS[1] + P[15][5]*vd*SH_TAS[0]);
Kfusion[16] = SK_TAS[0]*(P[16][3]*SH_TAS[2] - P[16][13]*SH_TAS[2] + P[16][4]*SK_TAS[1] - P[16][14]*SK_TAS[1] + P[16][5]*vd*SH_TAS[0]);
Kfusion[17] = SK_TAS[0]*(P[17][3]*SH_TAS[2] - P[17][13]*SH_TAS[2] + P[17][4]*SK_TAS[1] - P[17][14]*SK_TAS[1] + P[17][5]*vd*SH_TAS[0]);
Kfusion[18] = SK_TAS[0]*(P[18][3]*SH_TAS[2] - P[18][13]*SH_TAS[2] + P[18][4]*SK_TAS[1] - P[18][14]*SK_TAS[1] + P[18][5]*vd*SH_TAS[0]);
Kfusion[19] = SK_TAS[0]*(P[19][3]*SH_TAS[2] - P[19][13]*SH_TAS[2] + P[19][4]*SK_TAS[1] - P[19][14]*SK_TAS[1] + P[19][5]*vd*SH_TAS[0]);
Kfusion[20] = SK_TAS[0]*(P[20][3]*SH_TAS[2] - P[20][13]*SH_TAS[2] + P[20][4]*SK_TAS[1] - P[20][14]*SK_TAS[1] + P[20][5]*vd*SH_TAS[0]);
float SH_BETA[10][1];
SH_BETA[0] = (vn - vwn)*(sq(q0) + sq(q1) - sq(q2) - sq(q3)) - vd*(2*q0*q2 - 2*q1*q3) + (ve - vwe)*(2*q0*q3 + 2*q1*q2);
SH_BETA[1] = (ve - vwe)*(sq(q0) - sq(q1) + sq(q2) - sq(q3)) + vd*(2*q0*q1 + 2*q2*q3) - (vn - vwn)*(2*q0*q3 - 2*q1*q2);
SH_BETA[2] = vd*(sq(q0) - sq(q1) - sq(q2) + sq(q3)) - (ve - vwe)*(2*q0*q1 - 2*q2*q3) + (vn - vwn)*(2*q0*q2 + 2*q1*q3);
SH_BETA[3] = 1/sq(SH_BETA[0]);
SH_BETA[4] = (sq(q0) - sq(q1) + sq(q2) - sq(q3))/SH_BETA[0];
SH_BETA[5] = sq(q0) + sq(q1) - sq(q2) - sq(q3);
SH_BETA[6] = 1/SH_BETA[0];
SH_BETA[7] = 2*q0*q3;
SH_BETA[8] = SH_BETA[7] + 2*q1*q2;
SH_BETA[9] = SH_BETA[7] - 2*q1*q2;
float H_BETA[1][21];
H_BETA[0][0] = SH_BETA[2]*SH_BETA[6];
H_BETA[0][1] = SH_BETA[1]*SH_BETA[2]*SH_BETA[3];
H_BETA[0][2] = - sq(SH_BETA[1])*SH_BETA[3] - 1;
H_BETA[0][3] = - SH_BETA[6]*SH_BETA[9] - SH_BETA[1]*SH_BETA[3]*SH_BETA[5];
H_BETA[0][4] = SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8];
H_BETA[0][5] = SH_BETA[6]*(2*q0*q1 + 2*q2*q3) + SH_BETA[1]*SH_BETA[3]*(2*q0*q2 - 2*q1*q3);
H_BETA[0][13] = SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5];
H_BETA[0][14] = SH_BETA[1]*SH_BETA[3]*SH_BETA[8] - SH_BETA[4];
float SK_BETA[6][1];
SK_BETA[0] = 1/(R_BETA + (SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8])*(P[13][4]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[3][4]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[2][4]*(sq(SH_BETA[1])*SH_BETA[3] + 1) + P[5][4]*(SH_BETA[6]*(2*q0*q1 + 2*q2*q3) + SH_BETA[1]*SH_BETA[3]*(2*q0*q2 - 2*q1*q3)) + P[4][4]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) - P[14][4]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) + P[0][4]*SH_BETA[2]*SH_BETA[6] + P[1][4]*SH_BETA[1]*SH_BETA[2]*SH_BETA[3]) - (SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8])*(P[13][14]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[3][14]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[2][14]*(sq(SH_BETA[1])*SH_BETA[3] + 1) + P[5][14]*(SH_BETA[6]*(2*q0*q1 + 2*q2*q3) + SH_BETA[1]*SH_BETA[3]*(2*q0*q2 - 2*q1*q3)) + P[4][14]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) - P[14][14]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) + P[0][14]*SH_BETA[2]*SH_BETA[6] + P[1][14]*SH_BETA[1]*SH_BETA[2]*SH_BETA[3]) - (SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5])*(P[13][3]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[3][3]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[2][3]*(sq(SH_BETA[1])*SH_BETA[3] + 1) + P[5][3]*(SH_BETA[6]*(2*q0*q1 + 2*q2*q3) + SH_BETA[1]*SH_BETA[3]*(2*q0*q2 - 2*q1*q3)) + P[4][3]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) - P[14][3]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) + P[0][3]*SH_BETA[2]*SH_BETA[6] + P[1][3]*SH_BETA[1]*SH_BETA[2]*SH_BETA[3]) + (SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5])*(P[13][13]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[3][13]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[2][13]*(sq(SH_BETA[1])*SH_BETA[3] + 1) + P[5][13]*(SH_BETA[6]*(2*q0*q1 + 2*q2*q3) + SH_BETA[1]*SH_BETA[3]*(2*q0*q2 - 2*q1*q3)) + P[4][13]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) - P[14][13]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) + P[0][13]*SH_BETA[2]*SH_BETA[6] + P[1][13]*SH_BETA[1]*SH_BETA[2]*SH_BETA[3]) - (sq(SH_BETA[1])*SH_BETA[3] + 1)*(P[13][2]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[3][2]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[2][2]*(sq(SH_BETA[1])*SH_BETA[3] + 1) + P[5][2]*(SH_BETA[6]*(2*q0*q1 + 2*q2*q3) + SH_BETA[1]*SH_BETA[3]*(2*q0*q2 - 2*q1*q3)) + P[4][2]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) - P[14][2]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) + P[0][2]*SH_BETA[2]*SH_BETA[6] + P[1][2]*SH_BETA[1]*SH_BETA[2]*SH_BETA[3]) + (SH_BETA[6]*(2*q0*q1 + 2*q2*q3) + SH_BETA[1]*SH_BETA[3]*(2*q0*q2 - 2*q1*q3))*(P[13][5]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[3][5]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[2][5]*(sq(SH_BETA[1])*SH_BETA[3] + 1) + P[5][5]*(SH_BETA[6]*(2*q0*q1 + 2*q2*q3) + SH_BETA[1]*SH_BETA[3]*(2*q0*q2 - 2*q1*q3)) + P[4][5]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) - P[14][5]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) + P[0][5]*SH_BETA[2]*SH_BETA[6] + P[1][5]*SH_BETA[1]*SH_BETA[2]*SH_BETA[3]) + SH_BETA[2]*SH_BETA[6]*(P[13][0]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[3][0]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[2][0]*(sq(SH_BETA[1])*SH_BETA[3] + 1) + P[5][0]*(SH_BETA[6]*(2*q0*q1 + 2*q2*q3) + SH_BETA[1]*SH_BETA[3]*(2*q0*q2 - 2*q1*q3)) + P[4][0]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) - P[14][0]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) + P[0][0]*SH_BETA[2]*SH_BETA[6] + P[1][0]*SH_BETA[1]*SH_BETA[2]*SH_BETA[3]) + SH_BETA[1]*SH_BETA[2]*SH_BETA[3]*(P[13][1]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[3][1]*(SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5]) - P[2][1]*(sq(SH_BETA[1])*SH_BETA[3] + 1) + P[5][1]*(SH_BETA[6]*(2*q0*q1 + 2*q2*q3) + SH_BETA[1]*SH_BETA[3]*(2*q0*q2 - 2*q1*q3)) + P[4][1]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) - P[14][1]*(SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8]) + P[0][1]*SH_BETA[2]*SH_BETA[6] + P[1][1]*SH_BETA[1]*SH_BETA[2]*SH_BETA[3]));
SK_BETA[1] = SH_BETA[6]*(2*q0*q1 + 2*q2*q3) + SH_BETA[1]*SH_BETA[3]*(2*q0*q2 - 2*q1*q3);
SK_BETA[2] = SH_BETA[6]*SH_BETA[9] + SH_BETA[1]*SH_BETA[3]*SH_BETA[5];
SK_BETA[3] = SH_BETA[4] - SH_BETA[1]*SH_BETA[3]*SH_BETA[8];
SK_BETA[4] = sq(SH_BETA[1])*SH_BETA[3] + 1;
SK_BETA[5] = SH_BETA[2];
float Kfusion[21][1];
float Kfusion[1][1];
Kfusion[0] = SK_BETA[0]*(P[0][5]*SK_BETA[1] - P[0][2]*SK_BETA[4] - P[0][3]*SK_BETA[2] + P[0][4]*SK_BETA[3] + P[0][13]*SK_BETA[2] - P[0][14]*SK_BETA[3] + P[0][0]*SH_BETA[6]*SK_BETA[5] + P[0][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[1] = SK_BETA[0]*(P[1][5]*SK_BETA[1] - P[1][2]*SK_BETA[4] - P[1][3]*SK_BETA[2] + P[1][4]*SK_BETA[3] + P[1][13]*SK_BETA[2] - P[1][14]*SK_BETA[3] + P[1][0]*SH_BETA[6]*SK_BETA[5] + P[1][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[2] = SK_BETA[0]*(P[2][5]*SK_BETA[1] - P[2][2]*SK_BETA[4] - P[2][3]*SK_BETA[2] + P[2][4]*SK_BETA[3] + P[2][13]*SK_BETA[2] - P[2][14]*SK_BETA[3] + P[2][0]*SH_BETA[6]*SK_BETA[5] + P[2][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[3] = SK_BETA[0]*(P[3][5]*SK_BETA[1] - P[3][2]*SK_BETA[4] - P[3][3]*SK_BETA[2] + P[3][4]*SK_BETA[3] + P[3][13]*SK_BETA[2] - P[3][14]*SK_BETA[3] + P[3][0]*SH_BETA[6]*SK_BETA[5] + P[3][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[4] = SK_BETA[0]*(P[4][5]*SK_BETA[1] - P[4][2]*SK_BETA[4] - P[4][3]*SK_BETA[2] + P[4][4]*SK_BETA[3] + P[4][13]*SK_BETA[2] - P[4][14]*SK_BETA[3] + P[4][0]*SH_BETA[6]*SK_BETA[5] + P[4][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[5] = SK_BETA[0]*(P[5][5]*SK_BETA[1] - P[5][2]*SK_BETA[4] - P[5][3]*SK_BETA[2] + P[5][4]*SK_BETA[3] + P[5][13]*SK_BETA[2] - P[5][14]*SK_BETA[3] + P[5][0]*SH_BETA[6]*SK_BETA[5] + P[5][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[6] = SK_BETA[0]*(P[6][5]*SK_BETA[1] - P[6][2]*SK_BETA[4] - P[6][3]*SK_BETA[2] + P[6][4]*SK_BETA[3] + P[6][13]*SK_BETA[2] - P[6][14]*SK_BETA[3] + P[6][0]*SH_BETA[6]*SK_BETA[5] + P[6][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[7] = SK_BETA[0]*(P[7][5]*SK_BETA[1] - P[7][2]*SK_BETA[4] - P[7][3]*SK_BETA[2] + P[7][4]*SK_BETA[3] + P[7][13]*SK_BETA[2] - P[7][14]*SK_BETA[3] + P[7][0]*SH_BETA[6]*SK_BETA[5] + P[7][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[8] = SK_BETA[0]*(P[8][5]*SK_BETA[1] - P[8][2]*SK_BETA[4] - P[8][3]*SK_BETA[2] + P[8][4]*SK_BETA[3] + P[8][13]*SK_BETA[2] - P[8][14]*SK_BETA[3] + P[8][0]*SH_BETA[6]*SK_BETA[5] + P[8][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[9] = SK_BETA[0]*(P[9][5]*SK_BETA[1] - P[9][2]*SK_BETA[4] - P[9][3]*SK_BETA[2] + P[9][4]*SK_BETA[3] + P[9][13]*SK_BETA[2] - P[9][14]*SK_BETA[3] + P[9][0]*SH_BETA[6]*SK_BETA[5] + P[9][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[10] = SK_BETA[0]*(P[10][5]*SK_BETA[1] - P[10][2]*SK_BETA[4] - P[10][3]*SK_BETA[2] + P[10][4]*SK_BETA[3] + P[10][13]*SK_BETA[2] - P[10][14]*SK_BETA[3] + P[10][0]*SH_BETA[6]*SK_BETA[5] + P[10][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[11] = SK_BETA[0]*(P[11][5]*SK_BETA[1] - P[11][2]*SK_BETA[4] - P[11][3]*SK_BETA[2] + P[11][4]*SK_BETA[3] + P[11][13]*SK_BETA[2] - P[11][14]*SK_BETA[3] + P[11][0]*SH_BETA[6]*SK_BETA[5] + P[11][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[12] = SK_BETA[0]*(P[12][5]*SK_BETA[1] - P[12][2]*SK_BETA[4] - P[12][3]*SK_BETA[2] + P[12][4]*SK_BETA[3] + P[12][13]*SK_BETA[2] - P[12][14]*SK_BETA[3] + P[12][0]*SH_BETA[6]*SK_BETA[5] + P[12][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[13] = SK_BETA[0]*(P[13][5]*SK_BETA[1] - P[13][2]*SK_BETA[4] - P[13][3]*SK_BETA[2] + P[13][4]*SK_BETA[3] + P[13][13]*SK_BETA[2] - P[13][14]*SK_BETA[3] + P[13][0]*SH_BETA[6]*SK_BETA[5] + P[13][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[14] = SK_BETA[0]*(P[14][5]*SK_BETA[1] - P[14][2]*SK_BETA[4] - P[14][3]*SK_BETA[2] + P[14][4]*SK_BETA[3] + P[14][13]*SK_BETA[2] - P[14][14]*SK_BETA[3] + P[14][0]*SH_BETA[6]*SK_BETA[5] + P[14][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[15] = SK_BETA[0]*(P[15][5]*SK_BETA[1] - P[15][2]*SK_BETA[4] - P[15][3]*SK_BETA[2] + P[15][4]*SK_BETA[3] + P[15][13]*SK_BETA[2] - P[15][14]*SK_BETA[3] + P[15][0]*SH_BETA[6]*SK_BETA[5] + P[15][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[16] = SK_BETA[0]*(P[16][5]*SK_BETA[1] - P[16][2]*SK_BETA[4] - P[16][3]*SK_BETA[2] + P[16][4]*SK_BETA[3] + P[16][13]*SK_BETA[2] - P[16][14]*SK_BETA[3] + P[16][0]*SH_BETA[6]*SK_BETA[5] + P[16][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[17] = SK_BETA[0]*(P[17][5]*SK_BETA[1] - P[17][2]*SK_BETA[4] - P[17][3]*SK_BETA[2] + P[17][4]*SK_BETA[3] + P[17][13]*SK_BETA[2] - P[17][14]*SK_BETA[3] + P[17][0]*SH_BETA[6]*SK_BETA[5] + P[17][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[18] = SK_BETA[0]*(P[18][5]*SK_BETA[1] - P[18][2]*SK_BETA[4] - P[18][3]*SK_BETA[2] + P[18][4]*SK_BETA[3] + P[18][13]*SK_BETA[2] - P[18][14]*SK_BETA[3] + P[18][0]*SH_BETA[6]*SK_BETA[5] + P[18][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[19] = SK_BETA[0]*(P[19][5]*SK_BETA[1] - P[19][2]*SK_BETA[4] - P[19][3]*SK_BETA[2] + P[19][4]*SK_BETA[3] + P[19][13]*SK_BETA[2] - P[19][14]*SK_BETA[3] + P[19][0]*SH_BETA[6]*SK_BETA[5] + P[19][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
Kfusion[20] = SK_BETA[0]*(P[20][5]*SK_BETA[1] - P[20][2]*SK_BETA[4] - P[20][3]*SK_BETA[2] + P[20][4]*SK_BETA[3] + P[20][13]*SK_BETA[2] - P[20][14]*SK_BETA[3] + P[20][0]*SH_BETA[6]*SK_BETA[5] + P[20][1]*SH_BETA[1]*SH_BETA[3]*SK_BETA[5]);
float SH_MAG[9][1];
SH_MAG[0] = sq(q0) - sq(q1) + sq(q2) - sq(q3);
SH_MAG[1] = sq(q0) + sq(q1) - sq(q2) - sq(q3);
SH_MAG[2] = sq(q0) - sq(q1) - sq(q2) + sq(q3);
SH_MAG[3] = 2*q0*q1 + 2*q2*q3;
SH_MAG[4] = 2*q0*q3 + 2*q1*q2;
SH_MAG[5] = 2*q0*q2 + 2*q1*q3;
SH_MAG[6] = magE*(2*q0*q1 - 2*q2*q3);
SH_MAG[7] = 2*q1*q3 - 2*q0*q2;
SH_MAG[8] = 2*q0*q3;
float H_MAG[1][21];
H_MAG[1] = SH_MAG[6] - magD*SH_MAG[2] - magN*SH_MAG[5];
H_MAG[2] = magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2);
H_MAG[15] = SH_MAG[1];
H_MAG[16] = SH_MAG[4];
H_MAG[17] = SH_MAG[7];
H_MAG[18] = 1;
float SK_MX[4][1];
SK_MX[0] = 1/(P[18][18] + R_MAG - P[1][18]*(magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5]) + P[15][18]*SH_MAG[1] + P[16][18]*SH_MAG[4] + P[17][18]*SH_MAG[7] + P[2][18]*(magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2)) - (magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5])*(P[18][1] - P[1][1]*(magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5]) + P[15][1]*SH_MAG[1] + P[16][1]*SH_MAG[4] + P[17][1]*SH_MAG[7] + P[2][1]*(magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2))) + SH_MAG[1]*(P[18][15] - P[1][15]*(magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5]) + P[15][15]*SH_MAG[1] + P[16][15]*SH_MAG[4] + P[17][15]*SH_MAG[7] + P[2][15]*(magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2))) + SH_MAG[4]*(P[18][16] - P[1][16]*(magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5]) + P[15][16]*SH_MAG[1] + P[16][16]*SH_MAG[4] + P[17][16]*SH_MAG[7] + P[2][16]*(magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2))) + SH_MAG[7]*(P[18][17] - P[1][17]*(magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5]) + P[15][17]*SH_MAG[1] + P[16][17]*SH_MAG[4] + P[17][17]*SH_MAG[7] + P[2][17]*(magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2))) + (magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2))*(P[18][2] - P[1][2]*(magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5]) + P[15][2]*SH_MAG[1] + P[16][2]*SH_MAG[4] + P[17][2]*SH_MAG[7] + P[2][2]*(magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2))));
SK_MX[1] = magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2);
SK_MX[2] = magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5];
SK_MX[3] = SH_MAG[7];
float Kfusion[21][1];
float Kfusion[1][1];
Kfusion[0] = SK_MX[0]*(P[0][18] + P[0][15]*SH_MAG[1] + P[0][16]*SH_MAG[4] - P[0][1]*SK_MX[2] + P[0][2]*SK_MX[1] + P[0][17]*SK_MX[3]);
Kfusion[1] = SK_MX[0]*(P[1][18] + P[1][15]*SH_MAG[1] + P[1][16]*SH_MAG[4] - P[1][1]*SK_MX[2] + P[1][2]*SK_MX[1] + P[1][17]*SK_MX[3]);
Kfusion[2] = SK_MX[0]*(P[2][18] + P[2][15]*SH_MAG[1] + P[2][16]*SH_MAG[4] - P[2][1]*SK_MX[2] + P[2][2]*SK_MX[1] + P[2][17]*SK_MX[3]);
Kfusion[3] = SK_MX[0]*(P[3][18] + P[3][15]*SH_MAG[1] + P[3][16]*SH_MAG[4] - P[3][1]*SK_MX[2] + P[3][2]*SK_MX[1] + P[3][17]*SK_MX[3]);
Kfusion[4] = SK_MX[0]*(P[4][18] + P[4][15]*SH_MAG[1] + P[4][16]*SH_MAG[4] - P[4][1]*SK_MX[2] + P[4][2]*SK_MX[1] + P[4][17]*SK_MX[3]);
Kfusion[5] = SK_MX[0]*(P[5][18] + P[5][15]*SH_MAG[1] + P[5][16]*SH_MAG[4] - P[5][1]*SK_MX[2] + P[5][2]*SK_MX[1] + P[5][17]*SK_MX[3]);
Kfusion[6] = SK_MX[0]*(P[6][18] + P[6][15]*SH_MAG[1] + P[6][16]*SH_MAG[4] - P[6][1]*SK_MX[2] + P[6][2]*SK_MX[1] + P[6][17]*SK_MX[3]);
Kfusion[7] = SK_MX[0]*(P[7][18] + P[7][15]*SH_MAG[1] + P[7][16]*SH_MAG[4] - P[7][1]*SK_MX[2] + P[7][2]*SK_MX[1] + P[7][17]*SK_MX[3]);
Kfusion[8] = SK_MX[0]*(P[8][18] + P[8][15]*SH_MAG[1] + P[8][16]*SH_MAG[4] - P[8][1]*SK_MX[2] + P[8][2]*SK_MX[1] + P[8][17]*SK_MX[3]);
Kfusion[9] = SK_MX[0]*(P[9][18] + P[9][15]*SH_MAG[1] + P[9][16]*SH_MAG[4] - P[9][1]*SK_MX[2] + P[9][2]*SK_MX[1] + P[9][17]*SK_MX[3]);
Kfusion[10] = SK_MX[0]*(P[10][18] + P[10][15]*SH_MAG[1] + P[10][16]*SH_MAG[4] - P[10][1]*SK_MX[2] + P[10][2]*SK_MX[1] + P[10][17]*SK_MX[3]);
Kfusion[11] = SK_MX[0]*(P[11][18] + P[11][15]*SH_MAG[1] + P[11][16]*SH_MAG[4] - P[11][1]*SK_MX[2] + P[11][2]*SK_MX[1] + P[11][17]*SK_MX[3]);
Kfusion[12] = SK_MX[0]*(P[12][18] + P[12][15]*SH_MAG[1] + P[12][16]*SH_MAG[4] - P[12][1]*SK_MX[2] + P[12][2]*SK_MX[1] + P[12][17]*SK_MX[3]);
Kfusion[13] = SK_MX[0]*(P[13][18] + P[13][15]*SH_MAG[1] + P[13][16]*SH_MAG[4] - P[13][1]*SK_MX[2] + P[13][2]*SK_MX[1] + P[13][17]*SK_MX[3]);
Kfusion[14] = SK_MX[0]*(P[14][18] + P[14][15]*SH_MAG[1] + P[14][16]*SH_MAG[4] - P[14][1]*SK_MX[2] + P[14][2]*SK_MX[1] + P[14][17]*SK_MX[3]);
Kfusion[15] = SK_MX[0]*(P[15][18] + P[15][15]*SH_MAG[1] + P[15][16]*SH_MAG[4] - P[15][1]*SK_MX[2] + P[15][2]*SK_MX[1] + P[15][17]*SK_MX[3]);
Kfusion[16] = SK_MX[0]*(P[16][18] + P[16][15]*SH_MAG[1] + P[16][16]*SH_MAG[4] - P[16][1]*SK_MX[2] + P[16][2]*SK_MX[1] + P[16][17]*SK_MX[3]);
Kfusion[17] = SK_MX[0]*(P[17][18] + P[17][15]*SH_MAG[1] + P[17][16]*SH_MAG[4] - P[17][1]*SK_MX[2] + P[17][2]*SK_MX[1] + P[17][17]*SK_MX[3]);
Kfusion[18] = SK_MX[0]*(P[18][18] + P[18][15]*SH_MAG[1] + P[18][16]*SH_MAG[4] - P[18][1]*SK_MX[2] + P[18][2]*SK_MX[1] + P[18][17]*SK_MX[3]);
Kfusion[19] = SK_MX[0]*(P[19][18] + P[19][15]*SH_MAG[1] + P[19][16]*SH_MAG[4] - P[19][1]*SK_MX[2] + P[19][2]*SK_MX[1] + P[19][17]*SK_MX[3]);
Kfusion[20] = SK_MX[0]*(P[20][18] + P[20][15]*SH_MAG[1] + P[20][16]*SH_MAG[4] - P[20][1]*SK_MX[2] + P[20][2]*SK_MX[1] + P[20][17]*SK_MX[3]);
float H_MAG[1][21];
H_MAG[0] = magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5];
H_MAG[2] = - magE*SH_MAG[4] - magD*SH_MAG[7] - magN*SH_MAG[1];
H_MAG[15] = 2*q1*q2 - SH_MAG[8];
H_MAG[16] = SH_MAG[0];
H_MAG[17] = SH_MAG[3];
H_MAG[19] = 1;
float SK_MY[4][1];
SK_MY[0] = 1/(P[19][19] + R_MAG + P[0][19]*(magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5]) + P[16][19]*SH_MAG[0] + P[17][19]*SH_MAG[3] - (SH_MAG[8] - 2*q1*q2)*(P[19][15] + P[0][15]*(magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5]) + P[16][15]*SH_MAG[0] + P[17][15]*SH_MAG[3] - P[2][15]*(magE*SH_MAG[4] + magD*SH_MAG[7] + magN*SH_MAG[1]) - P[15][15]*(SH_MAG[8] - 2*q1*q2)) - P[2][19]*(magE*SH_MAG[4] + magD*SH_MAG[7] + magN*SH_MAG[1]) + (magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5])*(P[19][0] + P[0][0]*(magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5]) + P[16][0]*SH_MAG[0] + P[17][0]*SH_MAG[3] - P[2][0]*(magE*SH_MAG[4] + magD*SH_MAG[7] + magN*SH_MAG[1]) - P[15][0]*(SH_MAG[8] - 2*q1*q2)) + SH_MAG[0]*(P[19][16] + P[0][16]*(magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5]) + P[16][16]*SH_MAG[0] + P[17][16]*SH_MAG[3] - P[2][16]*(magE*SH_MAG[4] + magD*SH_MAG[7] + magN*SH_MAG[1]) - P[15][16]*(SH_MAG[8] - 2*q1*q2)) + SH_MAG[3]*(P[19][17] + P[0][17]*(magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5]) + P[16][17]*SH_MAG[0] + P[17][17]*SH_MAG[3] - P[2][17]*(magE*SH_MAG[4] + magD*SH_MAG[7] + magN*SH_MAG[1]) - P[15][17]*(SH_MAG[8] - 2*q1*q2)) - P[15][19]*(SH_MAG[8] - 2*q1*q2) - (magE*SH_MAG[4] + magD*SH_MAG[7] + magN*SH_MAG[1])*(P[19][2] + P[0][2]*(magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5]) + P[16][2]*SH_MAG[0] + P[17][2]*SH_MAG[3] - P[2][2]*(magE*SH_MAG[4] + magD*SH_MAG[7] + magN*SH_MAG[1]) - P[15][2]*(SH_MAG[8] - 2*q1*q2)));
SK_MY[1] = magE*SH_MAG[4] + magD*SH_MAG[7] + magN*SH_MAG[1];
SK_MY[2] = magD*SH_MAG[2] - SH_MAG[6] + magN*SH_MAG[5];
SK_MY[3] = SH_MAG[8] - 2*q1*q2;
float Kfusion[21][1];
float Kfusion[1][1];
Kfusion[0] = SK_MY[0]*(P[0][19] + P[0][16]*SH_MAG[0] + P[0][17]*SH_MAG[3] + P[0][0]*SK_MY[2] - P[0][2]*SK_MY[1] - P[0][15]*SK_MY[3]);
Kfusion[1] = SK_MY[0]*(P[1][19] + P[1][16]*SH_MAG[0] + P[1][17]*SH_MAG[3] + P[1][0]*SK_MY[2] - P[1][2]*SK_MY[1] - P[1][15]*SK_MY[3]);
Kfusion[2] = SK_MY[0]*(P[2][19] + P[2][16]*SH_MAG[0] + P[2][17]*SH_MAG[3] + P[2][0]*SK_MY[2] - P[2][2]*SK_MY[1] - P[2][15]*SK_MY[3]);
Kfusion[3] = SK_MY[0]*(P[3][19] + P[3][16]*SH_MAG[0] + P[3][17]*SH_MAG[3] + P[3][0]*SK_MY[2] - P[3][2]*SK_MY[1] - P[3][15]*SK_MY[3]);
Kfusion[4] = SK_MY[0]*(P[4][19] + P[4][16]*SH_MAG[0] + P[4][17]*SH_MAG[3] + P[4][0]*SK_MY[2] - P[4][2]*SK_MY[1] - P[4][15]*SK_MY[3]);
Kfusion[5] = SK_MY[0]*(P[5][19] + P[5][16]*SH_MAG[0] + P[5][17]*SH_MAG[3] + P[5][0]*SK_MY[2] - P[5][2]*SK_MY[1] - P[5][15]*SK_MY[3]);
Kfusion[6] = SK_MY[0]*(P[6][19] + P[6][16]*SH_MAG[0] + P[6][17]*SH_MAG[3] + P[6][0]*SK_MY[2] - P[6][2]*SK_MY[1] - P[6][15]*SK_MY[3]);
Kfusion[7] = SK_MY[0]*(P[7][19] + P[7][16]*SH_MAG[0] + P[7][17]*SH_MAG[3] + P[7][0]*SK_MY[2] - P[7][2]*SK_MY[1] - P[7][15]*SK_MY[3]);
Kfusion[8] = SK_MY[0]*(P[8][19] + P[8][16]*SH_MAG[0] + P[8][17]*SH_MAG[3] + P[8][0]*SK_MY[2] - P[8][2]*SK_MY[1] - P[8][15]*SK_MY[3]);
Kfusion[9] = SK_MY[0]*(P[9][19] + P[9][16]*SH_MAG[0] + P[9][17]*SH_MAG[3] + P[9][0]*SK_MY[2] - P[9][2]*SK_MY[1] - P[9][15]*SK_MY[3]);
Kfusion[10] = SK_MY[0]*(P[10][19] + P[10][16]*SH_MAG[0] + P[10][17]*SH_MAG[3] + P[10][0]*SK_MY[2] - P[10][2]*SK_MY[1] - P[10][15]*SK_MY[3]);
Kfusion[11] = SK_MY[0]*(P[11][19] + P[11][16]*SH_MAG[0] + P[11][17]*SH_MAG[3] + P[11][0]*SK_MY[2] - P[11][2]*SK_MY[1] - P[11][15]*SK_MY[3]);
Kfusion[12] = SK_MY[0]*(P[12][19] + P[12][16]*SH_MAG[0] + P[12][17]*SH_MAG[3] + P[12][0]*SK_MY[2] - P[12][2]*SK_MY[1] - P[12][15]*SK_MY[3]);
Kfusion[13] = SK_MY[0]*(P[13][19] + P[13][16]*SH_MAG[0] + P[13][17]*SH_MAG[3] + P[13][0]*SK_MY[2] - P[13][2]*SK_MY[1] - P[13][15]*SK_MY[3]);
Kfusion[14] = SK_MY[0]*(P[14][19] + P[14][16]*SH_MAG[0] + P[14][17]*SH_MAG[3] + P[14][0]*SK_MY[2] - P[14][2]*SK_MY[1] - P[14][15]*SK_MY[3]);
Kfusion[15] = SK_MY[0]*(P[15][19] + P[15][16]*SH_MAG[0] + P[15][17]*SH_MAG[3] + P[15][0]*SK_MY[2] - P[15][2]*SK_MY[1] - P[15][15]*SK_MY[3]);
Kfusion[16] = SK_MY[0]*(P[16][19] + P[16][16]*SH_MAG[0] + P[16][17]*SH_MAG[3] + P[16][0]*SK_MY[2] - P[16][2]*SK_MY[1] - P[16][15]*SK_MY[3]);
Kfusion[17] = SK_MY[0]*(P[17][19] + P[17][16]*SH_MAG[0] + P[17][17]*SH_MAG[3] + P[17][0]*SK_MY[2] - P[17][2]*SK_MY[1] - P[17][15]*SK_MY[3]);
Kfusion[18] = SK_MY[0]*(P[18][19] + P[18][16]*SH_MAG[0] + P[18][17]*SH_MAG[3] + P[18][0]*SK_MY[2] - P[18][2]*SK_MY[1] - P[18][15]*SK_MY[3]);
Kfusion[19] = SK_MY[0]*(P[19][19] + P[19][16]*SH_MAG[0] + P[19][17]*SH_MAG[3] + P[19][0]*SK_MY[2] - P[19][2]*SK_MY[1] - P[19][15]*SK_MY[3]);
Kfusion[20] = SK_MY[0]*(P[20][19] + P[20][16]*SH_MAG[0] + P[20][17]*SH_MAG[3] + P[20][0]*SK_MY[2] - P[20][2]*SK_MY[1] - P[20][15]*SK_MY[3]);
float H_MAG[1][21];
H_MAG[0] = magN*(SH_MAG[8] - 2*q1*q2) - magD*SH_MAG[3] - magE*SH_MAG[0];
H_MAG[1] = magE*SH_MAG[4] + magN*SH_MAG[1] - magD*(2*q0*q2 - 2*q1*q3);
H_MAG[15] = SH_MAG[5];
H_MAG[16] = 2*q2*q3 - 2*q0*q1;
H_MAG[17] = SH_MAG[2];
H_MAG[20] = 1;
float SK_MZ[4][1];
SK_MZ[0] = 1/(P[20][20] + R_MAG + P[15][20]*SH_MAG[5] + P[17][20]*SH_MAG[2] + SH_MAG[5]*(P[20][15] + P[15][15]*SH_MAG[5] + P[17][15]*SH_MAG[2] - P[0][15]*(magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2)) - P[16][15]*(2*q0*q1 - 2*q2*q3) + P[1][15]*(magE*SH_MAG[4] + magN*SH_MAG[1] - magD*(2*q0*q2 - 2*q1*q3))) + SH_MAG[2]*(P[20][17] + P[15][17]*SH_MAG[5] + P[17][17]*SH_MAG[2] - P[0][17]*(magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2)) - P[16][17]*(2*q0*q1 - 2*q2*q3) + P[1][17]*(magE*SH_MAG[4] + magN*SH_MAG[1] - magD*(2*q0*q2 - 2*q1*q3))) - P[0][20]*(magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2)) - (magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2))*(P[20][0] + P[15][0]*SH_MAG[5] + P[17][0]*SH_MAG[2] - P[0][0]*(magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2)) - P[16][0]*(2*q0*q1 - 2*q2*q3) + P[1][0]*(magE*SH_MAG[4] + magN*SH_MAG[1] - magD*(2*q0*q2 - 2*q1*q3))) - P[16][20]*(2*q0*q1 - 2*q2*q3) - (2*q0*q1 - 2*q2*q3)*(P[20][16] + P[15][16]*SH_MAG[5] + P[17][16]*SH_MAG[2] - P[0][16]*(magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2)) - P[16][16]*(2*q0*q1 - 2*q2*q3) + P[1][16]*(magE*SH_MAG[4] + magN*SH_MAG[1] - magD*(2*q0*q2 - 2*q1*q3))) + P[1][20]*(magE*SH_MAG[4] + magN*SH_MAG[1] - magD*(2*q0*q2 - 2*q1*q3)) + (magE*SH_MAG[4] + magN*SH_MAG[1] - magD*(2*q0*q2 - 2*q1*q3))*(P[20][1] + P[15][1]*SH_MAG[5] + P[17][1]*SH_MAG[2] - P[0][1]*(magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2)) - P[16][1]*(2*q0*q1 - 2*q2*q3) + P[1][1]*(magE*SH_MAG[4] + magN*SH_MAG[1] - magD*(2*q0*q2 - 2*q1*q3))));
SK_MZ[1] = magE*SH_MAG[4] + magN*SH_MAG[1] - magD*(2*q0*q2 - 2*q1*q3);
SK_MZ[2] = magE*SH_MAG[0] + magD*SH_MAG[3] - magN*(SH_MAG[8] - 2*q1*q2);
SK_MZ[3] = 2*q0*q1 - 2*q2*q3;
float Kfusion[21][1];
float Kfusion[1][1];
Kfusion[0] = SK_MZ[0]*(P[0][20] + P[0][17]*SH_MAG[2] + P[0][15]*SH_MAG[5] - P[0][0]*SK_MZ[2] + P[0][1]*SK_MZ[1] - P[0][16]*SK_MZ[3]);
Kfusion[1] = SK_MZ[0]*(P[1][20] + P[1][17]*SH_MAG[2] + P[1][15]*SH_MAG[5] - P[1][0]*SK_MZ[2] + P[1][1]*SK_MZ[1] - P[1][16]*SK_MZ[3]);
Kfusion[2] = SK_MZ[0]*(P[2][20] + P[2][17]*SH_MAG[2] + P[2][15]*SH_MAG[5] - P[2][0]*SK_MZ[2] + P[2][1]*SK_MZ[1] - P[2][16]*SK_MZ[3]);
Kfusion[3] = SK_MZ[0]*(P[3][20] + P[3][17]*SH_MAG[2] + P[3][15]*SH_MAG[5] - P[3][0]*SK_MZ[2] + P[3][1]*SK_MZ[1] - P[3][16]*SK_MZ[3]);
Kfusion[4] = SK_MZ[0]*(P[4][20] + P[4][17]*SH_MAG[2] + P[4][15]*SH_MAG[5] - P[4][0]*SK_MZ[2] + P[4][1]*SK_MZ[1] - P[4][16]*SK_MZ[3]);
Kfusion[5] = SK_MZ[0]*(P[5][20] + P[5][17]*SH_MAG[2] + P[5][15]*SH_MAG[5] - P[5][0]*SK_MZ[2] + P[5][1]*SK_MZ[1] - P[5][16]*SK_MZ[3]);
Kfusion[6] = SK_MZ[0]*(P[6][20] + P[6][17]*SH_MAG[2] + P[6][15]*SH_MAG[5] - P[6][0]*SK_MZ[2] + P[6][1]*SK_MZ[1] - P[6][16]*SK_MZ[3]);
Kfusion[7] = SK_MZ[0]*(P[7][20] + P[7][17]*SH_MAG[2] + P[7][15]*SH_MAG[5] - P[7][0]*SK_MZ[2] + P[7][1]*SK_MZ[1] - P[7][16]*SK_MZ[3]);
Kfusion[8] = SK_MZ[0]*(P[8][20] + P[8][17]*SH_MAG[2] + P[8][15]*SH_MAG[5] - P[8][0]*SK_MZ[2] + P[8][1]*SK_MZ[1] - P[8][16]*SK_MZ[3]);
Kfusion[9] = SK_MZ[0]*(P[9][20] + P[9][17]*SH_MAG[2] + P[9][15]*SH_MAG[5] - P[9][0]*SK_MZ[2] + P[9][1]*SK_MZ[1] - P[9][16]*SK_MZ[3]);
Kfusion[10] = SK_MZ[0]*(P[10][20] + P[10][17]*SH_MAG[2] + P[10][15]*SH_MAG[5] - P[10][0]*SK_MZ[2] + P[10][1]*SK_MZ[1] - P[10][16]*SK_MZ[3]);
Kfusion[11] = SK_MZ[0]*(P[11][20] + P[11][17]*SH_MAG[2] + P[11][15]*SH_MAG[5] - P[11][0]*SK_MZ[2] + P[11][1]*SK_MZ[1] - P[11][16]*SK_MZ[3]);
Kfusion[12] = SK_MZ[0]*(P[12][20] + P[12][17]*SH_MAG[2] + P[12][15]*SH_MAG[5] - P[12][0]*SK_MZ[2] + P[12][1]*SK_MZ[1] - P[12][16]*SK_MZ[3]);
Kfusion[13] = SK_MZ[0]*(P[13][20] + P[13][17]*SH_MAG[2] + P[13][15]*SH_MAG[5] - P[13][0]*SK_MZ[2] + P[13][1]*SK_MZ[1] - P[13][16]*SK_MZ[3]);
Kfusion[14] = SK_MZ[0]*(P[14][20] + P[14][17]*SH_MAG[2] + P[14][15]*SH_MAG[5] - P[14][0]*SK_MZ[2] + P[14][1]*SK_MZ[1] - P[14][16]*SK_MZ[3]);
Kfusion[15] = SK_MZ[0]*(P[15][20] + P[15][17]*SH_MAG[2] + P[15][15]*SH_MAG[5] - P[15][0]*SK_MZ[2] + P[15][1]*SK_MZ[1] - P[15][16]*SK_MZ[3]);
Kfusion[16] = SK_MZ[0]*(P[16][20] + P[16][17]*SH_MAG[2] + P[16][15]*SH_MAG[5] - P[16][0]*SK_MZ[2] + P[16][1]*SK_MZ[1] - P[16][16]*SK_MZ[3]);
Kfusion[17] = SK_MZ[0]*(P[17][20] + P[17][17]*SH_MAG[2] + P[17][15]*SH_MAG[5] - P[17][0]*SK_MZ[2] + P[17][1]*SK_MZ[1] - P[17][16]*SK_MZ[3]);
Kfusion[18] = SK_MZ[0]*(P[18][20] + P[18][17]*SH_MAG[2] + P[18][15]*SH_MAG[5] - P[18][0]*SK_MZ[2] + P[18][1]*SK_MZ[1] - P[18][16]*SK_MZ[3]);
Kfusion[19] = SK_MZ[0]*(P[19][20] + P[19][17]*SH_MAG[2] + P[19][15]*SH_MAG[5] - P[19][0]*SK_MZ[2] + P[19][1]*SK_MZ[1] - P[19][16]*SK_MZ[3]);
Kfusion[20] = SK_MZ[0]*(P[20][20] + P[20][17]*SH_MAG[2] + P[20][15]*SH_MAG[5] - P[20][0]*SK_MZ[2] + P[20][1]*SK_MZ[1] - P[20][16]*SK_MZ[3]);
float SH_LOS[11][1];
SH_LOS[0] = (q1*rotErrX)/2 - q0 + (q2*rotErrY)/2 + (q3*rotErrZ)/2;
SH_LOS[1] = q2 + (q0*rotErrY)/2 - (q1*rotErrZ)/2 + (q3*rotErrX)/2;
SH_LOS[2] = q1 + (q0*rotErrX)/2 + (q2*rotErrZ)/2 - (q3*rotErrY)/2;
SH_LOS[3] = q3 + (q0*rotErrZ)/2 + (q1*rotErrY)/2 - (q2*rotErrX)/2;
SH_LOS[4] = sq(SH_LOS[0]) - SH_LOS[1]sq() - SH_LOS[2]sq() + SH_LOS[3]sq();
SH_LOS[5] = vd*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]) - ve*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) + vn*(sq(SH_LOS[0]) - SH_LOS[1]sq() + SH_LOS[2]sq() - SH_LOS[3]sq());
SH_LOS[6] = vn*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - vd*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]) + ve*(sq(SH_LOS[0]) + SH_LOS[1]sq() - SH_LOS[2]sq() - SH_LOS[3]sq());
SH_LOS[7] = 1/(pd - ptd);
SH_LOS[8] = q0*SH_LOS[2] - q1*SH_LOS[0] + q3*SH_LOS[1] + q2*SH_LOS[3];
SH_LOS[9] = q1*SH_LOS[1] + q0*SH_LOS[3] + q3*SH_LOS[0] - q2*SH_LOS[2];
SH_LOS[10] = q2*SH_LOS[0] - q0*SH_LOS[1] + q1*SH_LOS[3] + q3*SH_LOS[2];
float H_LOS[1][21];
H_LOS[0] = SH_LOS[6]*SH_LOS[7]*SH_LOS[8] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]));
H_LOS[1] = - SH_LOS[6]*SH_LOS[7]*SH_LOS[10] - SH_LOS[4]*SH_LOS[7]*(vd*(q1*SH_LOS[1] + q0*SH_LOS[3] + q3*SH_LOS[0] - q2*SH_LOS[2]) + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3]));
H_LOS[2] = SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[10] + ve*(q1*SH_LOS[1] + q0*SH_LOS[3] - q3*SH_LOS[0] + q2*SH_LOS[2]) - vn*(q0*SH_LOS[0] - q1*SH_LOS[2] + q2*SH_LOS[1] + q3*SH_LOS[3])) - SH_LOS[6]*SH_LOS[7]*SH_LOS[9];
H_LOS[3] = -SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]);
H_LOS[4] = -SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) + SH_LOS[1]sq() - SH_LOS[2]sq() - SH_LOS[3]sq());
H_LOS[5] = SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]);
H_LOS[8] = (SH_LOS[4]*SH_LOS[6])/sq(pd - ptd);
float H_LOS[1][21];
H_LOS[0] = SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[9] + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3])) - SH_LOS[5]*SH_LOS[7]*SH_LOS[8];
H_LOS[1] = SH_LOS[5]*SH_LOS[7]*SH_LOS[10] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]));
H_LOS[2] = SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[8] - ve*(q0*SH_LOS[0] + q1*SH_LOS[2] - q2*SH_LOS[1] + q3*SH_LOS[3]) + vn*(q1*SH_LOS[1] - q0*SH_LOS[3] + q3*SH_LOS[0] + q2*SH_LOS[2])) + SH_LOS[5]*SH_LOS[7]*SH_LOS[9];
H_LOS[3] = SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) - SH_LOS[1]sq() + SH_LOS[2]sq() - SH_LOS[3]sq());
H_LOS[4] = -SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]);
H_LOS[5] = SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]);
H_LOS[8] = -(SH_LOS[4]*SH_LOS[5])/sq(pd - ptd);
float SK_LOS[10][1];
SK_LOS[0] = 1/(R_LOS + (SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[10] + ve*(q1*SH_LOS[1] + q0*SH_LOS[3] - q3*SH_LOS[0] + q2*SH_LOS[2]) - vn*(q0*SH_LOS[0] - q1*SH_LOS[2] + q2*SH_LOS[1] + q3*SH_LOS[3])) - SH_LOS[6]*SH_LOS[7]*SH_LOS[9])*(P[0][2]*(SH_LOS[6]*SH_LOS[7]*SH_LOS[8] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]))) - P[1][2]*(SH_LOS[6]*SH_LOS[7]*SH_LOS[10] + SH_LOS[4]*SH_LOS[7]*(vd*(q1*SH_LOS[1] + q0*SH_LOS[3] + q3*SH_LOS[0] - q2*SH_LOS[2]) + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3]))) + P[2][2]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[10] + ve*(q1*SH_LOS[1] + q0*SH_LOS[3] - q3*SH_LOS[0] + q2*SH_LOS[2]) - vn*(q0*SH_LOS[0] - q1*SH_LOS[2] + q2*SH_LOS[1] + q3*SH_LOS[3])) - SH_LOS[6]*SH_LOS[7]*SH_LOS[9]) - P[4][2]*SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) + sq(SH_LOS[1]) - SH_LOS[2]sq() - SH_LOS[3]sq()) + (P[8][2]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) - P[3][2]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) + P[5][2]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3])) + (SH_LOS[6]*SH_LOS[7]*SH_LOS[8] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2])))*(P[0][0]*(SH_LOS[6]*SH_LOS[7]*SH_LOS[8] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]))) - P[1][0]*(SH_LOS[6]*SH_LOS[7]*SH_LOS[10] + SH_LOS[4]*SH_LOS[7]*(vd*(q1*SH_LOS[1] + q0*SH_LOS[3] + q3*SH_LOS[0] - q2*SH_LOS[2]) + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3]))) + P[2][0]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[10] + ve*(q1*SH_LOS[1] + q0*SH_LOS[3] - q3*SH_LOS[0] + q2*SH_LOS[2]) - vn*(q0*SH_LOS[0] - q1*SH_LOS[2] + q2*SH_LOS[1] + q3*SH_LOS[3])) - SH_LOS[6]*SH_LOS[7]*SH_LOS[9]) - P[4][0]*SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) + sq(SH_LOS[1]) - SH_LOS[2]sq() - SH_LOS[3]sq()) + (P[8][0]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) - P[3][0]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) + P[5][0]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3])) - (SH_LOS[6]*SH_LOS[7]*SH_LOS[10] + SH_LOS[4]*SH_LOS[7]*(vd*(q1*SH_LOS[1] + q0*SH_LOS[3] + q3*SH_LOS[0] - q2*SH_LOS[2]) + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3])))*(P[0][1]*(SH_LOS[6]*SH_LOS[7]*SH_LOS[8] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]))) - P[1][1]*(SH_LOS[6]*SH_LOS[7]*SH_LOS[10] + SH_LOS[4]*SH_LOS[7]*(vd*(q1*SH_LOS[1] + q0*SH_LOS[3] + q3*SH_LOS[0] - q2*SH_LOS[2]) + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3]))) + P[2][1]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[10] + ve*(q1*SH_LOS[1] + q0*SH_LOS[3] - q3*SH_LOS[0] + q2*SH_LOS[2]) - vn*(q0*SH_LOS[0] - q1*SH_LOS[2] + q2*SH_LOS[1] + q3*SH_LOS[3])) - SH_LOS[6]*SH_LOS[7]*SH_LOS[9]) - P[4][1]*SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) + sq(SH_LOS[1]) - SH_LOS[2]sq() - SH_LOS[3]sq()) + (P[8][1]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) - P[3][1]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) + P[5][1]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3])) - SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) + sq(SH_LOS[1]) - SH_LOS[2]sq() - SH_LOS[3]sq())*(P[0][4]*(SH_LOS[6]*SH_LOS[7]*SH_LOS[8] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]))) - P[1][4]*(SH_LOS[6]*SH_LOS[7]*SH_LOS[10] + SH_LOS[4]*SH_LOS[7]*(vd*(q1*SH_LOS[1] + q0*SH_LOS[3] + q3*SH_LOS[0] - q2*SH_LOS[2]) + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3]))) + P[2][4]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[10] + ve*(q1*SH_LOS[1] + q0*SH_LOS[3] - q3*SH_LOS[0] + q2*SH_LOS[2]) - vn*(q0*SH_LOS[0] - q1*SH_LOS[2] + q2*SH_LOS[1] + q3*SH_LOS[3])) - SH_LOS[6]*SH_LOS[7]*SH_LOS[9]) - P[4][4]*SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) + sq(SH_LOS[1]) - SH_LOS[2]sq() - SH_LOS[3]sq()) + (P[8][4]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) - P[3][4]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) + P[5][4]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3])) + (SH_LOS[4]*SH_LOS[6]*(P[0][8]*(SH_LOS[6]*SH_LOS[7]*SH_LOS[8] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]))) - P[1][8]*(SH_LOS[6]*SH_LOS[7]*SH_LOS[10] + SH_LOS[4]*SH_LOS[7]*(vd*(q1*SH_LOS[1] + q0*SH_LOS[3] + q3*SH_LOS[0] - q2*SH_LOS[2]) + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3]))) + P[2][8]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[10] + ve*(q1*SH_LOS[1] + q0*SH_LOS[3] - q3*SH_LOS[0] + q2*SH_LOS[2]) - vn*(q0*SH_LOS[0] - q1*SH_LOS[2] + q2*SH_LOS[1] + q3*SH_LOS[3])) - SH_LOS[6]*SH_LOS[7]*SH_LOS[9]) - P[4][8]*SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) + sq(SH_LOS[1]) - SH_LOS[2]sq() - SH_LOS[3]sq()) + (P[8][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) - P[3][8]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) + P[5][8]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3])))/sq(pd - ptd) - SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2])*(P[0][3]*(SH_LOS[6]*SH_LOS[7]*SH_LOS[8] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]))) - P[1][3]*(SH_LOS[6]*SH_LOS[7]*SH_LOS[10] + SH_LOS[4]*SH_LOS[7]*(vd*(q1*SH_LOS[1] + q0*SH_LOS[3] + q3*SH_LOS[0] - q2*SH_LOS[2]) + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3]))) + P[2][3]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[10] + ve*(q1*SH_LOS[1] + q0*SH_LOS[3] - q3*SH_LOS[0] + q2*SH_LOS[2]) - vn*(q0*SH_LOS[0] - q1*SH_LOS[2] + q2*SH_LOS[1] + q3*SH_LOS[3])) - SH_LOS[6]*SH_LOS[7]*SH_LOS[9]) - P[4][3]*SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) + sq(SH_LOS[1]) - SH_LOS[2]sq() - SH_LOS[3]sq()) + (P[8][3]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) - P[3][3]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) + P[5][3]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3])) + SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3])*(P[0][5]*(SH_LOS[6]*SH_LOS[7]*SH_LOS[8] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]))) - P[1][5]*(SH_LOS[6]*SH_LOS[7]*SH_LOS[10] + SH_LOS[4]*SH_LOS[7]*(vd*(q1*SH_LOS[1] + q0*SH_LOS[3] + q3*SH_LOS[0] - q2*SH_LOS[2]) + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3]))) + P[2][5]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[10] + ve*(q1*SH_LOS[1] + q0*SH_LOS[3] - q3*SH_LOS[0] + q2*SH_LOS[2]) - vn*(q0*SH_LOS[0] - q1*SH_LOS[2] + q2*SH_LOS[1] + q3*SH_LOS[3])) - SH_LOS[6]*SH_LOS[7]*SH_LOS[9]) - P[4][5]*SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) + sq(SH_LOS[1]) - SH_LOS[2]sq() - SH_LOS[3]sq()) + (P[8][5]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) - P[3][5]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) + P[5][5]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3])));
SK_LOS[1] = 1/(R_LOS + (SH_LOS[5]*SH_LOS[7]*SH_LOS[10] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2])))*(P[1][1]*(SH_LOS[5]*SH_LOS[7]*SH_LOS[10] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]))) + P[0][1]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[9] + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3])) - SH_LOS[5]*SH_LOS[7]*SH_LOS[8]) + P[2][1]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[8] - ve*(q0*SH_LOS[0] + q1*SH_LOS[2] - q2*SH_LOS[1] + q3*SH_LOS[3]) + vn*(q1*SH_LOS[1] - q0*SH_LOS[3] + q3*SH_LOS[0] + q2*SH_LOS[2])) + SH_LOS[5]*SH_LOS[7]*SH_LOS[9]) + P[3][1]*SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) - sq(SH_LOS[1]) + SH_LOS[2]sq() - SH_LOS[3]sq()) - (P[8][1]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[4][1]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) + P[5][1]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3])) + (SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[9] + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3])) - SH_LOS[5]*SH_LOS[7]*SH_LOS[8])*(P[1][0]*(SH_LOS[5]*SH_LOS[7]*SH_LOS[10] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]))) + P[0][0]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[9] + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3])) - SH_LOS[5]*SH_LOS[7]*SH_LOS[8]) + P[2][0]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[8] - ve*(q0*SH_LOS[0] + q1*SH_LOS[2] - q2*SH_LOS[1] + q3*SH_LOS[3]) + vn*(q1*SH_LOS[1] - q0*SH_LOS[3] + q3*SH_LOS[0] + q2*SH_LOS[2])) + SH_LOS[5]*SH_LOS[7]*SH_LOS[9]) + P[3][0]*SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) - sq(SH_LOS[1]) + SH_LOS[2]sq() - SH_LOS[3]sq()) - (P[8][0]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[4][0]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) + P[5][0]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3])) + (SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[8] - ve*(q0*SH_LOS[0] + q1*SH_LOS[2] - q2*SH_LOS[1] + q3*SH_LOS[3]) + vn*(q1*SH_LOS[1] - q0*SH_LOS[3] + q3*SH_LOS[0] + q2*SH_LOS[2])) + SH_LOS[5]*SH_LOS[7]*SH_LOS[9])*(P[1][2]*(SH_LOS[5]*SH_LOS[7]*SH_LOS[10] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]))) + P[0][2]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[9] + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3])) - SH_LOS[5]*SH_LOS[7]*SH_LOS[8]) + P[2][2]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[8] - ve*(q0*SH_LOS[0] + q1*SH_LOS[2] - q2*SH_LOS[1] + q3*SH_LOS[3]) + vn*(q1*SH_LOS[1] - q0*SH_LOS[3] + q3*SH_LOS[0] + q2*SH_LOS[2])) + SH_LOS[5]*SH_LOS[7]*SH_LOS[9]) + P[3][2]*SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) - sq(SH_LOS[1]) + SH_LOS[2]sq() - SH_LOS[3]sq()) - (P[8][2]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[4][2]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) + P[5][2]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3])) + SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) - sq(SH_LOS[1]) + SH_LOS[2]sq() - SH_LOS[3]sq())*(P[1][3]*(SH_LOS[5]*SH_LOS[7]*SH_LOS[10] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]))) + P[0][3]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[9] + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3])) - SH_LOS[5]*SH_LOS[7]*SH_LOS[8]) + P[2][3]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[8] - ve*(q0*SH_LOS[0] + q1*SH_LOS[2] - q2*SH_LOS[1] + q3*SH_LOS[3]) + vn*(q1*SH_LOS[1] - q0*SH_LOS[3] + q3*SH_LOS[0] + q2*SH_LOS[2])) + SH_LOS[5]*SH_LOS[7]*SH_LOS[9]) + P[3][3]*SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) - sq(SH_LOS[1]) + SH_LOS[2]sq() - SH_LOS[3]sq()) - (P[8][3]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[4][3]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) + P[5][3]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3])) - (SH_LOS[4]*SH_LOS[5]*(P[1][8]*(SH_LOS[5]*SH_LOS[7]*SH_LOS[10] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]))) + P[0][8]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[9] + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3])) - SH_LOS[5]*SH_LOS[7]*SH_LOS[8]) + P[2][8]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[8] - ve*(q0*SH_LOS[0] + q1*SH_LOS[2] - q2*SH_LOS[1] + q3*SH_LOS[3]) + vn*(q1*SH_LOS[1] - q0*SH_LOS[3] + q3*SH_LOS[0] + q2*SH_LOS[2])) + SH_LOS[5]*SH_LOS[7]*SH_LOS[9]) + P[3][8]*SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) - sq(SH_LOS[1]) + SH_LOS[2]sq() - SH_LOS[3]sq()) - (P[8][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[4][8]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) + P[5][8]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3])))/sq(pd - ptd) - SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2])*(P[1][4]*(SH_LOS[5]*SH_LOS[7]*SH_LOS[10] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]))) + P[0][4]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[9] + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3])) - SH_LOS[5]*SH_LOS[7]*SH_LOS[8]) + P[2][4]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[8] - ve*(q0*SH_LOS[0] + q1*SH_LOS[2] - q2*SH_LOS[1] + q3*SH_LOS[3]) + vn*(q1*SH_LOS[1] - q0*SH_LOS[3] + q3*SH_LOS[0] + q2*SH_LOS[2])) + SH_LOS[5]*SH_LOS[7]*SH_LOS[9]) + P[3][4]*SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) - sq(SH_LOS[1]) + SH_LOS[2]sq() - SH_LOS[3]sq()) - (P[8][4]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[4][4]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) + P[5][4]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3])) + SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3])*(P[1][5]*(SH_LOS[5]*SH_LOS[7]*SH_LOS[10] - SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]))) + P[0][5]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[9] + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3])) - SH_LOS[5]*SH_LOS[7]*SH_LOS[8]) + P[2][5]*(SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[8] - ve*(q0*SH_LOS[0] + q1*SH_LOS[2] - q2*SH_LOS[1] + q3*SH_LOS[3]) + vn*(q1*SH_LOS[1] - q0*SH_LOS[3] + q3*SH_LOS[0] + q2*SH_LOS[2])) + SH_LOS[5]*SH_LOS[7]*SH_LOS[9]) + P[3][5]*SH_LOS[4]*SH_LOS[7]*(sq(SH_LOS[0]) - sq(SH_LOS[1]) + SH_LOS[2]sq() - SH_LOS[3]sq()) - (P[8][5]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[4][5]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) + P[5][5]*SH_LOS[4]*SH_LOS[7]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3])));
SK_LOS[2] = SH_LOS[4]*SH_LOS[7]*(ve*(q1*SH_LOS[0] - q0*SH_LOS[2] + q3*SH_LOS[1] + q2*SH_LOS[3]) - vd*(q0*SH_LOS[0] + q1*SH_LOS[2] + q2*SH_LOS[1] - q3*SH_LOS[3]) + vn*(q0*SH_LOS[1] - q2*SH_LOS[0] + q1*SH_LOS[3] + q3*SH_LOS[2]));
SK_LOS[3] = SH_LOS[6]*SH_LOS[7]*SH_LOS[10] + SH_LOS[4]*SH_LOS[7]*(vd*(q1*SH_LOS[1] + q0*SH_LOS[3] + q3*SH_LOS[0] - q2*SH_LOS[2]) + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3]));
SK_LOS[4] = SH_LOS[6]*SH_LOS[7]*SH_LOS[9] - SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[10] + ve*(q1*SH_LOS[1] + q0*SH_LOS[3] - q3*SH_LOS[0] + q2*SH_LOS[2]) - vn*(q0*SH_LOS[0] - q1*SH_LOS[2] + q2*SH_LOS[1] + q3*SH_LOS[3]));
SK_LOS[5] = SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[8] - ve*(q0*SH_LOS[0] + q1*SH_LOS[2] - q2*SH_LOS[1] + q3*SH_LOS[3]) + vn*(q1*SH_LOS[1] - q0*SH_LOS[3] + q3*SH_LOS[0] + q2*SH_LOS[2])) + SH_LOS[5]*SH_LOS[7]*SH_LOS[9];
SK_LOS[6] = SH_LOS[5]*SH_LOS[7]*SH_LOS[8] - SH_LOS[4]*SH_LOS[7]*(vd*SH_LOS[9] + ve*(q0*SH_LOS[1] + q2*SH_LOS[0] - q1*SH_LOS[3] + q3*SH_LOS[2]) + vn*(q1*SH_LOS[0] + q0*SH_LOS[2] - q3*SH_LOS[1] + q2*SH_LOS[3]));
SK_LOS[7] = sq(SH_LOS[0]) - SH_LOS[1]sq() + SH_LOS[2]sq() - SH_LOS[3]sq();
SK_LOS[8] = sq(SH_LOS[0]) + SH_LOS[1]sq() - SH_LOS[2]sq() - SH_LOS[3]sq();
SK_LOS[9] = SH_LOS[7];
float Kfusion[21][1];
float Kfusion[1][1];
Kfusion[0] = -SK_LOS[0]*(P[0][1]*SK_LOS[3] - P[0][2]*(SH_LOS[4]*SK_LOS[9]*(vd*SH_LOS[10] + ve*(q1*SH_LOS[1] + q0*SH_LOS[3] - q3*SH_LOS[0] + q2*SH_LOS[2]) - vn*(q0*SH_LOS[0] - q1*SH_LOS[2] + q2*SH_LOS[1] + q3*SH_LOS[3])) - SH_LOS[6]*SH_LOS[9]*SK_LOS[9]) + P[0][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[0][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[0][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[0][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[0][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[1] = -SK_LOS[0]*(P[1][1]*SK_LOS[3] + P[1][2]*SK_LOS[4] + P[1][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[1][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[1][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[1][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[1][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[2] = -SK_LOS[0]*(P[2][1]*SK_LOS[3] + P[2][2]*SK_LOS[4] + P[2][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[2][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[2][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[2][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[2][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[3] = -SK_LOS[0]*(P[3][1]*SK_LOS[3] + P[3][2]*SK_LOS[4] + P[3][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[3][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[3][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[3][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[3][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[4] = -SK_LOS[0]*(P[4][1]*SK_LOS[3] + P[4][2]*SK_LOS[4] + P[4][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[4][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[4][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[4][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[4][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[5] = -SK_LOS[0]*(P[5][1]*SK_LOS[3] + P[5][2]*SK_LOS[4] + P[5][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[5][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[5][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[5][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[5][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[6] = -SK_LOS[0]*(P[6][1]*SK_LOS[3] + P[6][2]*SK_LOS[4] + P[6][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[6][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[6][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[6][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[6][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[7] = -SK_LOS[0]*(P[7][1]*SK_LOS[3] + P[7][2]*SK_LOS[4] + P[7][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[7][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[7][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[7][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[7][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[8] = -SK_LOS[0]*(P[8][1]*SK_LOS[3] + P[8][2]*SK_LOS[4] + P[8][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[8][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[8][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[8][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[8][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[9] = -SK_LOS[0]*(P[9][1]*SK_LOS[3] + P[9][2]*SK_LOS[4] + P[9][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[9][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[9][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[9][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[9][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[10] = -SK_LOS[0]*(P[10][1]*SK_LOS[3] + P[10][2]*SK_LOS[4] + P[10][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[10][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[10][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[10][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[10][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[11] = -SK_LOS[0]*(P[11][1]*SK_LOS[3] + P[11][2]*SK_LOS[4] + P[11][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[11][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[11][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[11][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[11][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[12] = -SK_LOS[0]*(P[12][1]*SK_LOS[3] + P[12][2]*SK_LOS[4] + P[12][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[12][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[12][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[12][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[12][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[13] = -SK_LOS[0]*(P[13][1]*SK_LOS[3] + P[13][2]*SK_LOS[4] + P[13][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[13][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[13][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[13][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[13][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[14] = -SK_LOS[0]*(P[14][1]*SK_LOS[3] + P[14][2]*SK_LOS[4] + P[14][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[14][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[14][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[14][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[14][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[15] = -SK_LOS[0]*(P[15][1]*SK_LOS[3] + P[15][2]*SK_LOS[4] + P[15][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[15][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[15][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[15][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[15][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[16] = -SK_LOS[0]*(P[16][1]*SK_LOS[3] + P[16][2]*SK_LOS[4] + P[16][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[16][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[16][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[16][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[16][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[17] = -SK_LOS[0]*(P[17][1]*SK_LOS[3] + P[17][2]*SK_LOS[4] + P[17][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[17][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[17][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[17][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[17][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[18] = -SK_LOS[0]*(P[18][1]*SK_LOS[3] + P[18][2]*SK_LOS[4] + P[18][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[18][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[18][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[18][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[18][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[19] = -SK_LOS[0]*(P[19][1]*SK_LOS[3] + P[19][2]*SK_LOS[4] + P[19][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[19][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[19][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[19][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[19][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
Kfusion[20] = -SK_LOS[0]*(P[20][1]*SK_LOS[3] + P[20][2]*SK_LOS[4] + P[20][0]*(SK_LOS[2] - SH_LOS[6]*SH_LOS[8]*SK_LOS[9]) - (P[20][8]*SH_LOS[4]*SH_LOS[6])/sq(pd - ptd) + P[20][4]*SH_LOS[4]*SK_LOS[8]*SK_LOS[9] + P[20][3]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] + 2*SH_LOS[1]*SH_LOS[2]) - P[20][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[2] - 2*SH_LOS[1]*SH_LOS[3]));
float Kfusion[21][1];
float Kfusion[1][1];
Kfusion[0] = -SK_LOS[1]*(P[0][0]*SK_LOS[6] - P[0][2]*SK_LOS[5] + P[0][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[0][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[0][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[0][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[0][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[1] = -SK_LOS[1]*(P[1][0]*SK_LOS[6] - P[1][2]*SK_LOS[5] + P[1][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[1][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[1][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[1][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[1][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[2] = -SK_LOS[1]*(P[2][0]*SK_LOS[6] - P[2][2]*SK_LOS[5] + P[2][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[2][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[2][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[2][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[2][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[3] = -SK_LOS[1]*(P[3][0]*SK_LOS[6] - P[3][2]*SK_LOS[5] + P[3][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[3][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[3][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[3][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[3][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[4] = -SK_LOS[1]*(P[4][0]*SK_LOS[6] - P[4][2]*SK_LOS[5] + P[4][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[4][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[4][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[4][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[4][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[5] = -SK_LOS[1]*(P[5][0]*SK_LOS[6] - P[5][2]*SK_LOS[5] + P[5][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[5][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[5][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[5][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[5][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[6] = -SK_LOS[1]*(P[6][0]*SK_LOS[6] - P[6][2]*SK_LOS[5] + P[6][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[6][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[6][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[6][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[6][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[7] = -SK_LOS[1]*(P[7][0]*SK_LOS[6] - P[7][2]*SK_LOS[5] + P[7][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[7][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[7][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[7][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[7][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[8] = -SK_LOS[1]*(P[8][0]*SK_LOS[6] - P[8][2]*SK_LOS[5] + P[8][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[8][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[8][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[8][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[8][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[9] = -SK_LOS[1]*(P[9][0]*SK_LOS[6] - P[9][2]*SK_LOS[5] + P[9][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[9][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[9][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[9][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[9][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[10] = -SK_LOS[1]*(P[10][0]*SK_LOS[6] - P[10][2]*SK_LOS[5] + P[10][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[10][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[10][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[10][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[10][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[11] = -SK_LOS[1]*(P[11][0]*SK_LOS[6] - P[11][2]*SK_LOS[5] + P[11][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[11][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[11][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[11][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[11][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[12] = -SK_LOS[1]*(P[12][0]*SK_LOS[6] - P[12][2]*SK_LOS[5] + P[12][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[12][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[12][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[12][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[12][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[13] = -SK_LOS[1]*(P[13][0]*SK_LOS[6] - P[13][2]*SK_LOS[5] + P[13][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[13][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[13][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[13][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[13][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[14] = -SK_LOS[1]*(P[14][0]*SK_LOS[6] - P[14][2]*SK_LOS[5] + P[14][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[14][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[14][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[14][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[14][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[15] = -SK_LOS[1]*(P[15][0]*SK_LOS[6] - P[15][2]*SK_LOS[5] + P[15][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[15][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[15][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[15][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[15][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[16] = -SK_LOS[1]*(P[16][0]*SK_LOS[6] - P[16][2]*SK_LOS[5] + P[16][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[16][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[16][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[16][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[16][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[17] = -SK_LOS[1]*(P[17][0]*SK_LOS[6] - P[17][2]*SK_LOS[5] + P[17][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[17][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[17][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[17][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[17][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[18] = -SK_LOS[1]*(P[18][0]*SK_LOS[6] - P[18][2]*SK_LOS[5] + P[18][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[18][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[18][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[18][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[18][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[19] = -SK_LOS[1]*(P[19][0]*SK_LOS[6] - P[19][2]*SK_LOS[5] + P[19][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[19][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[19][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[19][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[19][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
Kfusion[20] = -SK_LOS[1]*(P[20][0]*SK_LOS[6] - P[20][2]*SK_LOS[5] + P[20][1]*(SK_LOS[2] - SH_LOS[5]*SH_LOS[10]*SK_LOS[9]) + (P[20][8]*SH_LOS[4]*SH_LOS[5])/sq(pd - ptd) - P[20][3]*SH_LOS[4]*SK_LOS[7]*SK_LOS[9] + P[20][4]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[3] - 2*SH_LOS[1]*SH_LOS[2]) - P[20][5]*SH_LOS[4]*SK_LOS[9]*(2*SH_LOS[0]*SH_LOS[1] + 2*SH_LOS[2]*SH_LOS[3]));
